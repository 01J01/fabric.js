var fabric=fabric||{version:0.2};fabric.log=function(){};fabric.warn=function(){};if(typeof console!=="undefined"){if(typeof console.log!=="undefined"&&console.log.apply)fabric.log=function(){return console.log.apply(console,arguments)};if(typeof console.warn!=="undefined"&&console.warn.apply)fabric.warn=function(){return console.warn.apply(console,arguments)}}if(!this.JSON)this.JSON={};
(function(){function A(f){return f<10?"0"+f:f}function m(f){l.lastIndex=0;return l.test(f)?'"'+f.replace(l,function(c){var h=b[c];return typeof h==="string"?h:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function d(f,c){var h,n,q,w,v=r,t,z=c[f];if(z&&typeof z==="object"&&typeof z.toJSON==="function")z=z.toJSON(f);if(typeof g==="function")z=g.call(c,f,z);switch(typeof z){case "string":return m(z);case "number":return isFinite(z)?String(z):"null";case "boolean":case "null":return String(z);
case "object":if(!z)return"null";r+=u;t=[];if(Object.prototype.toString.apply(z)==="[object Array]"){w=z.length;for(h=0;h<w;h+=1)t[h]=d(h,z)||"null";q=t.length===0?"[]":r?"[\n"+r+t.join(",\n"+r)+"\n"+v+"]":"["+t.join(",")+"]";r=v;return q}if(g&&typeof g==="object"){w=g.length;for(h=0;h<w;h+=1){n=g[h];if(typeof n==="string")if(q=d(n,z))t.push(m(n)+(r?": ":":")+q)}}else for(n in z)if(Object.hasOwnProperty.call(z,n))if(q=d(n,z))t.push(m(n)+(r?": ":":")+q);q=t.length===0?"{}":r?"{\n"+r+t.join(",\n"+r)+
"\n"+v+"}":"{"+t.join(",")+"}";r=v;return q}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+A(this.getUTCMonth()+1)+"-"+A(this.getUTCDate())+"T"+A(this.getUTCHours())+":"+A(this.getUTCMinutes())+":"+A(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var k=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
l=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r,u,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;if(typeof JSON.stringify!=="function")JSON.stringify=function(f,c,h){var n;u=r="";if(typeof h==="number")for(n=0;n<h;n+=1)u+=" ";else if(typeof h==="string")u=h;if((g=c)&&typeof c!=="function"&&(typeof c!=="object"||typeof c.length!=="number"))throw Error("JSON.stringify");return d("",
{"":f})};if(typeof JSON.parse!=="function")JSON.parse=function(f,c){function h(q,w){var v,t,z=q[w];if(z&&typeof z==="object")for(v in z)if(Object.hasOwnProperty.call(z,v)){t=h(z,v);if(t!==undefined)z[v]=t;else delete z[v]}return c.call(q,w,z)}var n;f=String(f);k.lastIndex=0;if(k.test(f))f=f.replace(k,function(q){return"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=eval("("+f+")");return typeof c==="function"?h({"":n},""):n}throw new SyntaxError("JSON.parse");}})();(function(){var A=document.defaultView;if(A&&A.getComputedStyle)if(A.getComputedStyle(document.documentElement,"")===null)A.getComputedStyle=function(m){return m.style}})();
var Cufon=function(){function A(x){var p=this.face=x.face;this.glyphs=x.glyphs;this.w=x.w;this.baseSize=parseInt(p["units-per-em"],10);this.family=p["font-family"].toLowerCase();this.weight=p["font-weight"];this.style=p["font-style"]||"normal";this.viewBox=function(){var a=p.bbox.split(/\s+/);a={minX:parseInt(a[0],10),minY:parseInt(a[1],10),maxX:parseInt(a[2],10),maxY:parseInt(a[3],10)};a.width=a.maxX-a.minX;a.height=a.maxY-a.minY;a.toString=function(){return[this.minX,this.minY,this.width,this.height].join(" ")};
return a}();this.ascent=-parseInt(p.ascent,10);this.descent=-parseInt(p.descent,10);this.height=-this.ascent+this.descent}function m(){var x={},p={oblique:"italic",italic:"oblique"};this.add=function(a){(x[a.style]||(x[a.style]={}))[a.weight]=a};this.get=function(a,e){var o=x[a]||x[p[a]]||x.normal||x.italic||x.oblique;if(!o)return null;e={normal:400,bold:700}[e]||parseInt(e,10);if(o[e])return o[e];var s={1:1,99:0}[e%100],y=[],C,B;if(s===undefined)s=e>400;if(e==500)e=400;for(var E in o){E=parseInt(E,
10);if(!C||E<C)C=E;if(!B||E>B)B=E;y.push(E)}if(e<C)e=C;if(e>B)e=B;y.sort(function(G,H){return(s?G>e&&H>e?G<H:G>H:G<e&&H<e?G>H:G<H)?-1:1});return o[y[0]]}}function d(x){var p={},a={};this.get=function(e){return p[e]!=undefined?p[e]:x[e]};this.getSize=function(e,o){return a[e]||(a[e]=new h.Size(this.get(e),o))};this.extend=function(e){for(var o in e)p[o]=e[o];return this}}function k(x,p,a){if(x.addEventListener)x.addEventListener(p,a,false);else x.attachEvent&&x.attachEvent("on"+p,function(){return a.call(x,
window.event)})}function l(x){var p={};return function(a){p.hasOwnProperty(a)||(p[a]=x.apply(null,arguments));return p[a]}}function r(x){return document.getElementsByTagName(x)}function u(){for(var x={},p,a=0,e=arguments.length;a<e;++a)for(p in arguments[a])x[p]=arguments[a][p];return x}function b(x,p,a,e,o,s){var y=e.separate;if(y=="none")return t[e.engine].apply(null,arguments);var C=document.createDocumentFragment(),B=p.split(F[y]),E=y=="words";if(E&&n){/^\s/.test(p)&&B.unshift("");/\s$/.test(p)&&
B.push("")}for(var G=0,H=B.length;G<H;++G)(y=t[e.engine](x,E?h.textAlign(B[G],a,G,H):B[G],a,e,o,s,G<H-1))&&C.appendChild(y);return C}function g(x,p){var a,e,o,s;o=q.get(x);if(!o.options){p.hover&&p.hoverables[x.nodeName.toLowerCase()]&&w.attach(x);o.options=p}for(var y=x.firstChild;y;y=o){o=y.nextSibling;s=false;if(y.nodeType==1){if(!y.firstChild)continue;if(/cufon/.test(y.className))s=true;else{arguments.callee(y,p);continue}}e||(e=h.getStyle(x).extend(p));if(!a)a:{(a=e)||(a=h.getStyle(x));for(var C=
h.quotedList(a.get("fontFamily").toLowerCase()),B=void 0,E=0,G=C.length;E<G;++E){B=C[E];if(z[B]){a=z[B].get(a.get("fontStyle"),a.get("fontWeight"));break a}}a=null}if(a)if(s)t[p.engine](a,null,e,p,y,x);else{s=y.data;if(s!=="")(s=b(a,s,e,p,y,x))?y.parentNode.replaceChild(s,y):y.parentNode.removeChild(y)}}}var f=function(){return f.replace.apply(null,arguments)},c=f.DOM={ready:function(){var x=false,p={loaded:1,complete:1},a=[],e=function(){if(!x){x=true;for(var o;o=a.shift();o());}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",
e,false);window.addEventListener("pageshow",e,false)}!window.opera&&document.readyState&&function(){p[document.readyState]?e():setTimeout(arguments.callee,10)}();document.readyState&&document.createStyleSheet&&function(){try{document.body.doScroll("left");e()}catch(o){setTimeout(arguments.callee,1)}}();k(window,"load",e);return function(o){if(arguments.length)x?o():a.push(o);else e()}}()},h=f.CSS={Size:function(x,p){this.value=parseFloat(x);this.unit=String(x).match(/[a-z%]*$/)[0]||"px";this.convert=
function(a){return a/p*this.value};this.convertFrom=function(a){return a/this.value*p};this.toString=function(){return this.value+this.unit}},getStyle:function(x){return new d(x.style)},quotedList:l(function(x){for(var p=[],a=/\s*((["'])([\s\S]*?[^\\])\2|[^,]+)\s*/g,e;e=a.exec(x);)p.push(e[3]||e[1]);return p}),ready:function(){var x=false,p=[],a=Object.prototype.propertyIsEnumerable?r("style"):{length:0},e=r("link");c.ready(function(){for(var o=0,s,y=0,C=e.length;s=e[y],y<C;++y)!s.disabled&&s.rel.toLowerCase()==
"stylesheet"&&++o;if(document.styleSheets.length>=a.length+o)for(x=true;o=p.shift();o());else setTimeout(arguments.callee,10)});return function(o){x?o():p.push(o)}}(),supports:function(x,p){var a=document.createElement("span").style;if(a[x]===undefined)return false;a[x]=p;return a[x]===p},textAlign:function(x,p,a,e){if(p.get("textAlign")=="right"){if(a>0)x=" "+x}else if(a<e-1)x+=" ";return x},textDecoration:function(x,p){p||(p=this.getStyle(x));for(var a={underline:null,overline:null,"line-through":null},
e=x;e.parentNode&&e.parentNode.nodeType==1;){var o=true;for(var s in a)if(!a[s]){if(p.get("textDecoration").indexOf(s)!=-1)a[s]=p.get("color");o=false}if(o)break;p=this.getStyle(e=e.parentNode)}return a},textShadow:l(function(x){if(x=="none")return null;for(var p=[],a={},e,o=0,s=/(#[a-f0-9]+|[a-z]+\(.*?\)|[a-z]+)|(-?[\d.]+[a-z%]*)|,/ig;e=s.exec(x);)if(e[0]==","){p.push(a);a={};o=0}else if(e[1])a.color=e[1];else a[["offX","offY","blur"][o++]]=e[2];p.push(a);return p}),color:l(function(x){var p={};
p.color=x.replace(/^rgba\((.*?),\s*([\d.]+)\)/,function(a,e,o){p.opacity=parseFloat(o);return"rgb("+e+")"});return p}),textTransform:function(x,p){return x[{uppercase:"toUpperCase",lowercase:"toLowerCase"}[p.get("textTransform")]||"toString"]()}},n=" ".split(/\s+/).length==0,q=new function(){var x={},p=0;this.get=function(a){a=a.cufid||(a.cufid=++p);return x[a]||(x[a]={})}},w=new (function(){function x(e){e=e.relatedTarget;var o;if(!(o=!e))o=this.contains?this.contains(e):this.compareDocumentPosition(e)&
16;o||a(this)}function p(){a(this)}function a(e){setTimeout(function(){f.replace(e,q.get(e).options,true)},10)}this.attach=function(e){if(e.onmouseenter===undefined){k(e,"mouseover",x);k(e,"mouseout",x)}else{k(e,"mouseenter",p);k(e,"mouseleave",p)}}}),v=[],t={},z={},D={enableTextDecoration:false,engine:null,hover:false,hoverables:{a:true},printable:true,selector:window.Sizzle||window.jQuery&&function(x){return jQuery(x)}||window.dojo&&dojo.query||window.$$&&function(x){return $$(x)}||window.$&&function(x){return $(x)}||
document.querySelectorAll&&function(x){return document.querySelectorAll(x)}||r,separate:"words",textShadow:"none"},F={words:/\s+/,characters:""};f.now=function(){c.ready();return f};f.refresh=function(){for(var x=v.splice(0,v.length),p=0,a=x.length;p<a;++p)f.replace.apply(null,x[p]);return f};f.registerEngine=function(x,p){if(!p)return f;t[x]=p;return f.set("engine",x)};f.registerFont=function(x){x=new A(x);var p=x.family;z[p]||(z[p]=new m);z[p].add(x);return f.set("fontFamily",'"'+p+'"')};f.replace=
function(x,p,a){p=u(D,p);if(!p.engine)return f;if(typeof p.textShadow=="string"&&p.textShadow)p.textShadow=h.textShadow(p.textShadow);a||v.push(arguments);if(x.nodeType||typeof x=="string")x=[x];h.ready(function(){for(var e=0,o=x.length;e<o;++e){var s=x[e];typeof s=="string"?f.replace(p.selector(s),p,true):g(s,p)}});return f};f.replaceElement=function(x,p){p=u(D,p);if(typeof p.textShadow=="string"&&p.textShadow)p.textShadow=h.textShadow(p.textShadow);return g(x,p)};f.engines=t;f.fonts=z;f.getOptions=
function(){return u(D)};f.set=function(x,p){D[x]=p;return f};return f}();
Cufon.registerEngine("canvas",function(){var A=document.createElement("canvas");if(!(!A||!A.getContext||!A.getContext.apply)){A=null;var m=Cufon.CSS.supports("display","inline-block");A=!m&&(document.compatMode=="BackCompat"||/frameset|transitional/i.test(document.doctype.publicId));var d=document.createElement("style");d.type="text/css";d.appendChild(document.createTextNode(".cufon-canvas{text-indent:0}@media screen,projection{.cufon-canvas{display:inline;display:inline-block;position:relative;vertical-align:middle"+(A?
"":";font-size:1px;line-height:1px")+"}.cufon-canvas .cufon-alt{display:-moz-inline-box;display:inline-block;width:0;height:0;overflow:hidden}"+(m?".cufon-canvas canvas{position:relative}":".cufon-canvas canvas{position:absolute}")+"}@media print{.cufon-canvas{padding:0 !important}.cufon-canvas canvas{display:none}.cufon-canvas .cufon-alt{display:inline}}"));document.getElementsByTagName("head")[0].appendChild(d);return function(k,l,r,u,b,g){function f(G,H){B.strokeStyle=H;B.beginPath();B.moveTo(0,
G);B.lineTo(y,G);B.stroke()}function c(){if(E){B.save();B.transform(1,0,-0.25,1,0,0)}for(var G=0,H=0,K=s.length;H<K;++H)if(s[H]==="\n"){B.translate(-G,-k.ascent);G=0}else{var J=k.glyphs[s[H]]||k.missingGlyph;if(J){B.beginPath();if(J.d)if(J.code)for(var N=J.code,I=B,R=0,O=N.length;R<O;++R){var M=N[R];I[M.m].apply(I,M.a)}else{N=J;I="m"+J.d;R=B;M=O=0;var P=[],T=/([mrvxe])([^a-z]*)/g,S=void 0,Q=0;a:for(;S=T.exec(I);++Q){var L=S[2].split(",");switch(S[1]){case "v":P[Q]={m:"bezierCurveTo",a:[O+~~L[0],M+
~~L[1],O+~~L[2],M+~~L[3],O+=~~L[4],M+=~~L[5]]};break;case "r":P[Q]={m:"lineTo",a:[O+=~~L[0],M+=~~L[1]]};break;case "m":P[Q]={m:"moveTo",a:[O=~~L[0],M=~~L[1]]};break;case "x":P[Q]={m:"closePath"};break;case "e":break a}R[P[Q].m].apply(R,P[Q].a)}N.code=P}B.fill();J=Number(J.w||k.w)+w;B.translate(J,0);G+=J}}E&&B.restore()}var h=l===null,n=k.viewBox,q=r.getSize("fontSize",k.baseSize),w=r.get("letterSpacing");w=w=="normal"?0:q.convertFrom(parseInt(w,10));var v=0,t=0,z=0,D=0,F=u.textShadow,x=[];if(F)for(var p=
0,a=F.length;p<a;++p){var e=F[p],o=q.convertFrom(parseFloat(e.offX));e=q.convertFrom(parseFloat(e.offY));x[p]=[o,e];if(e<v)v=e;if(o>t)t=o;if(e>z)z=e;if(o<D)D=o}var s=Cufon.CSS.textTransform(h?b.alt:l,r).split(""),y=0;e=null;p=o=0;for(a=s.length;p<a;++p)if(s[p]==="\n"){if(y>o)o=y;y=0}else{var C=k.glyphs[s[p]]||k.missingGlyph;if(C)y+=e=Number(C.w||k.w)+w}y=Math.max(o,y);if(e===null)return null;t+=n.width-e;D+=n.minX;if(h){h=b;p=b.firstChild}else{h=document.createElement("span");h.className="cufon cufon-canvas";
h.alt=l;p=document.createElement("canvas");h.appendChild(p);if(u.printable){a=document.createElement("span");a.className="cufon-alt";a.appendChild(document.createTextNode(l));h.appendChild(a)}}l=h.style;a=p.style;b=q.convert(n.height-v+z);z=Math.ceil(b);b=z/b;p.width=Math.ceil(q.convert(y+t-D)*b);p.height=z;v+=n.minY;a.top=Math.round(q.convert(v-k.ascent))+"px";a.left=Math.round(q.convert(D))+"px";t=Math.ceil(q.convert(y*b));a=t+"px";q=q.convert(k.height);Cufon.textOptions.width=t;Cufon.textOptions.height=
q;if(m){l.width=a;l.height=q+"px"}else{l.paddingLeft=a;l.paddingBottom=q-1+"px"}var B=Cufon.textOptions.context||p.getContext("2d");n=z/n.height;B.save();B.scale(n,n);B.translate(-D-1/n*p.width/2+(Cufon.fonts[k.family].offsetLeft||0),-v-1/n*p.height/2);B.lineWidth=k.face["underline-thickness"];B.save();g=u.enableTextDecoration?Cufon.CSS.textDecoration(g,r):{};var E=u.fontStyle==="italic";B.fillStyle=Cufon.textOptions.color||r.get("color");g.underline&&f(-k.face["underline-position"],B.fillStyle);
g.overline&&f(k.ascent,B.fillStyle);if(F){p=0;for(a=F.length;p<a;++p){e=F[p];B.save();B.fillStyle=e.color;B.translate.apply(B,x[p]);c();B.restore()}}B.save();c();B.restore();g["line-through"]&&f(-k.descent,B.fillStyle);B.restore();B.restore();return h}}}());
Cufon.registerEngine("vml",function(){function A(d,k){if(/px$/i.test(k))return parseFloat(k);var l=d.style.left,r=d.runtimeStyle.left;d.runtimeStyle.left=d.currentStyle.left;d.style.left=k;var u=d.style.pixelLeft;d.style.left=l;d.runtimeStyle.left=r;return u}if(document.namespaces){var m=document.createElement("canvas");if(!(m&&m.getContext&&m.getContext.apply)){document.namespaces.cvml==null&&document.namespaces.add("cvml","urn:schemas-microsoft-com:vml");m=document.createElement("cvml:shape");m.style.behavior=
"url(#default#VML)";if(m.coordsize){m=null;document.write('<style type="text/css">.cufon-vml-canvas{text-indent:0}@media screen{cvml\\:shape,cvml\\:shadow{behavior:url(#default#VML);display:block;antialias:true;position:absolute}.cufon-vml-canvas{position:absolute;text-align:left}.cufon-vml{display:inline-block;position:relative;vertical-align:middle}.cufon-vml .cufon-alt{position:absolute;left:-10000in;font-size:1px}a .cufon-vml{cursor:pointer}}@media print{.cufon-vml *{display:none}.cufon-vml .cufon-alt{display:inline}}</style>');
return function(d,k,l,r,u,b,g){var f=k===null;if(f)k=u.alt;var c=d.viewBox,h;if(!(h=l.computedFontSize)){h=Cufon.CSS.Size;var n;n=l.get("fontSize");n=A(b,/(?:em|ex|%)$/i.test(n)?"1em":n);h=l.computedFontSize=new h(n+"px",d.baseSize)}h=h;n=l.computedLSpacing;if(n==undefined){n=l.get("letterSpacing");l.computedLSpacing=n=n=="normal"?0:~~h.convertFrom(A(b,n))}var q;if(f){q=u;u=u.firstChild}else{q=document.createElement("span");q.className="cufon cufon-vml";q.alt=k;u=document.createElement("span");u.className=
"cufon-vml-canvas";q.appendChild(u);if(r.printable){var w=document.createElement("span");w.className="cufon-alt";w.appendChild(document.createTextNode(k));q.appendChild(w)}g||q.appendChild(document.createElement("cvml:shape"))}g=q.style;var v=u.style,t=h.convert(c.height);w=Math.ceil(t);t=w/t;var z=c.minX,D=c.minY;v.height=w;v.top=Math.round(h.convert(D-d.ascent));v.left=Math.round(h.convert(z));g.height=h.convert(d.height)+"px";r.enableTextDecoration&&Cufon.CSS.textDecoration(b,l);b=l.get("color");
k=Cufon.CSS.textTransform(k,l).split("");v=l=0;var F=null,x;r=r.textShadow;for(var p=0,a=0,e=k.length;p<e;++p)if(x=d.glyphs[k[p]]||d.missingGlyph)l+=F=~~(x.w||d.w)+n;if(F===null)return null;x=-z+l+(c.width-F);p=h.convert(x*t);F=Math.round(p);var o=x+","+c.height,s,y="r"+o+"nsnf";for(p=0;p<e;++p)if(x=d.glyphs[k[p]]||d.missingGlyph){if(f){c=u.childNodes[a];c.firstChild&&c.removeChild(c.firstChild)}else{c=document.createElement("cvml:shape");u.appendChild(c)}c.stroked="f";c.coordsize=o;c.coordorigin=
s=z-v+","+D;c.path=(x.d?"m"+x.d+"xe":"")+"m"+s+y;c.fillcolor=b;s=c.style;s.width=F;s.height=w;if(r){s=r[0];var C=r[1],B=Cufon.CSS.color(s.color),E,G=document.createElement("cvml:shadow");G.on="t";G.color=B.color;G.offset=s.offX+","+s.offY;if(C){E=Cufon.CSS.color(C.color);G.type="double";G.color2=E.color;G.offset2=C.offX+","+C.offY}G.opacity=B.opacity||E&&E.opacity||1;c.appendChild(G)}v+=~~(x.w||d.w)+n;++a}g.width=Math.max(Math.ceil(h.convert(l*t)),0);return q}}}}}());
(function(A){function m(c,h){for(var n in h)c[n]=h[n];return c}function d(c){return b.call(c,0)}function k(c,h){var n=document.createElement(c);for(var q in h)if(q==="class")n.className=h[q];else if(q==="for")n.htmlFor=h[q];else n.setAttribute(q,h[q]);return n}var l=A.fabric||(A.fabric={}),r=Array.prototype.slice,u=Function.prototype.apply;l.util={};(function(){var c=Math.PI/180;l.util.removeFromArray=function(h,n){var q=h.indexOf(n);q!==-1&&h.splice(q,1);return h};l.util.degreesToRadians=function(h){return h*
c};l.util.toFixed=function(h,n){return parseFloat(Number(h).toFixed(n))};l.util.getRandomInt=function(h,n){return Math.floor(Math.random()*(n-h+1))+h};l.util.falseFunction=function(){return false}})();if(!Array.prototype.indexOf)Array.prototype.indexOf=function(c,h){var n=this.length>>>0;h=Number(h)||0;h=Math[h<0?"ceil":"floor"](h);if(h<0)h+=n;for(;h<n;h++)if(h in this&&this[h]===c)return h;return-1};if(!Array.prototype.forEach)Array.prototype.forEach=function(c,h){for(var n=0,q=this.length>>>0;n<
q;n++)n in this&&c.call(h,this[n],n,this)};if(!Array.prototype.map)Array.prototype.map=function(c,h){for(var n=[],q=0,w=this.length>>>0;q<w;q++)if(q in this)n[q]=c.call(h,this[q],q,this);return n};if(!Array.prototype.every)Array.prototype.every=function(c,h){for(var n=0,q=this.length>>>0;n<q;n++)if(n in this&&!c.call(h,this[n],n,this))return false;return true};if(!Array.prototype.some)Array.prototype.some=function(c,h){for(var n=0,q=this.length>>>0;n<q;n++)if(n in this&&c.call(h,this[n],n,this))return true;
return false};if(!Array.prototype.filter)Array.prototype.filter=function(c,h){for(var n=[],q,w=0,v=this.length>>>0;w<v;w++)if(w in this){q=this[w];c.call(h,q,w,this)&&n.push(q)}return n};if(!Array.prototype.reduce)Array.prototype.reduce=function(c){var h=this.length>>>0,n=0,q;if(arguments.length>1)q=arguments[1];else{do{if(n in this){q=this[n++];break}if(++n>=h)throw new TypeError;}while(1)}for(;n<h;n++)if(n in this)q=c.call(null,q,this[n],n,this);return q};l.util.array={invoke:function(c,h){for(var n=
r.call(arguments,2),q=[],w=0,v=c.length;w<v;w++)q[w]=n.length?c[w][h].apply(c[w],n):c[w][h].call(c[w]);return q},min:function(c,h){var n=c.length-1,q=h?c[n][h]:c[n];if(h)for(;n--;){if(c[n][h]<q)q=c[n][h]}else for(;n--;)if(c[n]<q)q=c[n];return q},max:function(c,h){var n=c.length-1,q=h?c[n][h]:c[n];if(h)for(;n--;){if(c[n][h]>=q)q=c[n][h]}else for(;n--;)if(c[n]>=q)q=c[n];return q}};l.util.object={extend:m,clone:function(c){return m({},c)}};if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,
"").replace(/[\s\xA0]+$/,"")};l.util.string={camelize:function(c){return c.replace(/-+(.)?/g,function(h,n){return n?n.toUpperCase():""})},capitalize:function(c){return c.charAt(0).toUpperCase()+c.slice(1).toLowerCase()}};if(!Function.prototype.bind)Function.prototype.bind=function(c){var h=this,n=r.call(arguments,1);return n.length?function(){return u.call(h,c,n.concat(r.call(arguments)))}:function(){return u.call(h,c,arguments)}};(function(){function c(){}var h;h=function(){for(var n in{toString:1})if(n===
"toString")return false;return true}()?function(n,q){if(q.toString!==Object.prototype.toString)n.prototype.toString=q.toString;if(q.valueOf!==Object.prototype.valueOf)n.prototype.valueOf=q.valueOf;for(var w in q)n.prototype[w]=q[w]}:function(n,q){for(var w in q)n.prototype[w]=q[w]};l.util.createClass=function(){function n(){this.initialize.apply(this,arguments)}var q=null,w=r.call(arguments,0);if(typeof w[0]==="function")q=w.shift();n.superclass=q;n.subclasses=[];if(q){c.prototype=q.prototype;n.prototype=
new c;q.subclasses.push(n)}q=0;for(var v=w.length;q<v;q++)h(n,w[q]);if(!n.prototype.initialize)n.prototype.initialize=emptyFunction;return n.prototype.constructor=n}})();(function(){function c(p){var a=Array.prototype.slice.call(arguments,1),e,o,s=a.length;for(o=0;o<s;o++){e=typeof p[a[o]];if(!/^(?:function|object|unknown)$/.test(e))return false}return true}function h(p,a){return function(e){a.call(w(p),e||window.event)}}function n(p,a){return function(e){if(F[p]&&F[p][a])for(var o=F[p][a],s=0,y=
o.length;s<y;s++)o[s].call(this,e||window.event)}}var q=function(){if(typeof document.documentElement.uniqueID!=="undefined")return function(a){return a.uniqueID};var p=0;return function(a){return a.__uniqueID||(a.__uniqueID="uniqueID__"+p++)}}(),w,v;(function(){var p={};w=function(a){return p[a]};v=function(a,e){p[a]=e}})();var t=c(document.documentElement,"addEventListener","removeEventListener")&&c(window,"addEventListener","removeEventListener"),z=c(document.documentElement,"attachEvent","detachEvent")&&
c(window,"attachEvent","detachEvent"),D={},F={};if(t){t=function(p,a,e){p.addEventListener(a,e,false)};z=function(p,a,e){p.removeEventListener(a,e,false)}}else if(z){t=function(p,a,e){var o=q(p);v(o,p);D[o]||(D[o]={});D[o][a]||(D[o][a]=[]);e={handler:e,wrappedHandler:h(o,e)};D[o][a].push(e);p.attachEvent("on"+a,e.wrappedHandler)};z=function(p,a,e){var o=q(p),s;if(D[o]&&D[o][a])for(var y=0,C=D[o][a].length;y<C;y++)if((s=D[o][a][y])&&s.handler===e){p.detachEvent("on"+a,s.wrappedHandler);D[o][a][y]=
null}}}else{t=function(p,a,e){var o=q(p);F[o]||(F[o]={});if(!F[o][a]){F[o][a]=[];var s=p["on"+a];s&&F[o][a].push(s);p["on"+a]=n(o,a)}F[o][a].push(e)};z=function(p,a,e){p=q(p);if(F[p]&&F[p][a]){a=F[p][a];p=0;for(var o=a.length;p<o;p++)a[p]===e&&a.splice(p,1)}}}l.util.addListener=t;l.util.removeListener=z;var x={};l.util.getPointer=function(p){var a=document.documentElement,e=document.body||{scrollLeft:0},o=document.documentElement,s=document.body||{scrollTop:0};return{x:p.pageX||(typeof p.clientX!=
"unknown"?p.clientX:0)+(a.scrollLeft||e.scrollLeft)-(a.clientLeft||0),y:p.pageY||(typeof p.clientY!="unknown"?p.clientY:0)+(o.scrollTop||s.scrollTop)-(o.clientTop||0)}};l.util.observeEvent=function(p,a){x[p]||(x[p]=[]);x[p].push(a)};l.util.stopObservingEvent=function(p,a){x[p]&&l.util.removeFromArray(x[p],a)};l.util.fireEvent=function(p,a){var e=x[p];if(e)for(var o=0,s=e.length;o<s;o++)e[o]({memo:a})}})(this);(function(){var c=document.createElement("div"),h=typeof c.style.filter==="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,
q=function(w){return w};if(typeof c.style.opacity==="string")q=function(w,v){w.style.opacity=v;return w};else if(h)q=function(w,v){var t=w.style;if(w.currentStyle&&!w.currentStyle.hasLayout)t.zoom=1;if(n.test(t.filter)){v=v>=0.9999?"":"alpha(opacity="+v*100+")";t.filter=t.filter.replace(n,v)}else t.filter+=" alpha(opacity="+v*100+")";return w};l.util.setStyle=function(w,v){var t=w.style;if(typeof v==="string"){w.style.cssText+=";"+v;return v.indexOf("opacity")>-1?q(w,v.match(/opacity:\s*(\d?\.?\d*)/)[1]):
w}for(var z in v)if(z==="opacity")q(w,v[z]);else t[z==="float"||z==="cssFloat"?typeof t.styleFloat==="undefined"?"cssFloat":"styleFloat":z]=v[z];return w}})();var b=Array.prototype.slice;try{var g=d(document.childNodes)instanceof Array}catch(f){}g||(d=function(c){for(var h=Array(c.length),n=c.length;n--;)h[n]=c[n];return h});(function(){var c=document.documentElement.style,h="userSelect"in c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in
c?"KhtmlUserSelect":"";l.util.makeElementUnselectable=function(n){if(typeof n.onselectstart!=="undefined")n.onselectstart=l.util.falseFunction;if(h)n.style[h]="none";else if(typeof n.unselectable=="string")n.unselectable="on";return n}})();(function(){function c(n,q){h.load(n);q()}l.util.getScript=function(n,q){var w=document.getElementsByTagName("head")[0],v=document.createElement("script"),t=true;v.type="text/javascript";v.setAttribute("runat","server");v.onload=v.onreadystatechange=function(z){if(t)if(!(typeof this.readyState==
"string"&&this.readyState!=="loaded"&&this.readyState!=="complete")){t=false;q(z||window.event);v=v.onload=v.onreadystatechange=null}};v.src=n;w.appendChild(v)};var h=A.Jaxer;if(h&&h.load)l.util.getScript=c})();l.util.getById=function(c){return typeof c==="string"?document.getElementById(c):c};l.util.toArray=d;l.util.makeElement=k;l.util.addClass=function(c,h){if((" "+c.className+" ").indexOf(" "+h+" ")===-1)c.className+=(c.className?" ":"")+h};l.util.wrapElement=function(c,h,n){if(typeof h==="string")h=
k(h,n);c.parentNode&&c.parentNode.replaceChild(h,c);h.appendChild(c);return h};l.util.getElementOffset=function(c){var h=0,n=0;do{h+=c.offsetTop||0;n+=c.offsetLeft||0;c=c.offsetParent}while(c);return{left:n,top:h}};l.util.animate=function(c){c||(c={});var h=+new Date,n=c.duration||500,q=h+n,w,v,t=c.onChange||function(){},z=c.easing||function(a){return-Math.cos(a*Math.PI)/2+0.5},D="startValue"in c?c.startValue:0,F="endValue"in c?c.endValue:100,x=D>F;c.onStart&&c.onStart();var p=setInterval(function(){w=
+new Date;v=w>q?1:(w-h)/n;t(x?D-(D-F)*z(v):D+(F-D)*z(v));if(w>q){clearInterval(p);c.onComplete&&c.onComplete()}},10)};(function(){function c(){}var h=function(){for(var n=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],q=n.length;q--;)try{if(n[q]())return n[q]}catch(w){}}();l.util.request=function(n,q){q||(q={});var w=q.method?q.method.toUpperCase():
"GET",v=q.onComplete||function(){},t=h(),z;t.onreadystatechange=function(){if(t.readyState===4){v(t);t.onreadystatechange=c}};if(w==="GET"){z=null;if(typeof q.parameters=="string")n=n+(/\?/.test(n)?"&":"?")+q.parameters}t.open(w,n,true);if(w==="POST"||w==="PUT")t.setRequestHeader("Content-Type","application/x-www-form-urlencoded");t.send(z);return t}})()})(this);
(function(A){function m(f){var c=l.Element.activeInstance;if(c=c?c.getContext():null)for(var h=f.length;h--;){var n=f[h].get("fill");if(/^url\(/.test(n)){n=n.slice(5,n.length-1);l.gradientDefs[n]&&f[h].set("fill",l.Gradient.fromElement(l.gradientDefs[n],c,f[h]))}}}function d(f){f=f.getElementsByTagName("style");for(var c={},h,n=0,q=f.length;n<q;n++){h=f[0].textContent;h=h.replace(/\/\*[\s\S]*?\*\//g,"");h=h.match(/[^{]*\{[\s\S]*?\}/g);h=h.map(function(w){return w.trim()});h.forEach(function(w){var v=
w.match(/([\s\S]*?)\s*\{([^}]*)\}/);w=v[1];v=v[2].trim().replace(/;$/,"").split(/\s*;\s*/);c[w]||(c[w]={});for(var t=0,z=v.length;t<z;t++){var D=v[t].split(/\s*:\s*/);c[w][D[0]]=D[1]}})}return c}function k(f){var c=f.nodeName,h=f.getAttribute("class");f=f.getAttribute("id");var n={};for(var q in l.cssRules)if(h&&RegExp("^\\."+h).test(q)||f&&RegExp("^#"+f).test(q)||RegExp("^"+c).test(q))for(var w in l.cssRules[q])n[w]=l.cssRules[q][w];return n}var l=A.fabric||(A.fabric={}),r=l.util.object.extend,u=
l.util.string.capitalize,b=l.util.object.clone,g={cx:"left",x:"left",cy:"top",y:"top",r:"radius","fill-opacity":"opacity","fill-rule":"fillRule","stroke-width":"strokeWidth",transform:"transformMatrix"};l.parseTransformAttribute=function(){function f(v,t){var z=t[0];v[0]=Math.cos(z);v[1]=Math.sin(z);v[2]=-Math.sin(z);v[3]=Math.cos(z)}function c(v,t){var z=t.length===2?t[1]:t[0];v[0]=t[0];v[3]=z}function h(v,t){v[4]=t[0];if(t.length===2)v[5]=t[1]}var n=[1,0,0,1,0,0],q=RegExp("^\\s*(?:(?:(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\)))(?:(?:\\s+,?\\s*|,\\s*)(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))))*)?)\\s*$"),
w=RegExp("(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\)))");
return function(v){var t=n.concat();if(!v||v&&!q.test(v))return t;v.replace(w,function(z){var D=RegExp("(?:(?:(matrix)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(translate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(scale)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(rotate)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))(?:\\s+,?\\s*|,\\s*)((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)))?\\s*\\))|(?:(skewX)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\))|(?:(skewY)\\s*\\(\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))\\s*\\)))").exec(z).filter(function(F){return F!==
""&&F!=null});z=D[1];D=D.slice(2).map(parseFloat);switch(z){case "translate":h(t,D);break;case "rotate":f(t,D);break;case "scale":c(t,D);break;case "skewX":t[2]=D[0];break;case "skewY":t[1]=D[0];break;case "matrix":t=D;break}});return t}}();l.parseSVGDocument=function(){var f=/^(path|circle|polygon|polyline|ellipse|rect|line|image)$/,c=RegExp("^\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)+)\\s*,?\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)+)\\s*,?\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)+)\\s*,?\\s*((?:[-+]?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?)+)\\s*$");
return function(h,n){if(h){var q=new Date,w=l.util.toArray(h.getElementsByTagName("*")).filter(function(p){var a;if(a=f.test(p.tagName)){a:{p=p;for(a=/^(?:pattern|defs)$/;p&&(p=p.parentNode);)if(a.test(p.nodeName)){p=true;break a}p=false}a=!p}return a});if(!(!w||w&&!w.length)){var v=h.getAttribute("viewBox"),t=h.getAttribute("width"),z=h.getAttribute("height"),D=null,F=null;if(v&&(v=v.match(c))){parseInt(v[1],10);parseInt(v[2],10);D=parseInt(v[3],10);F=parseInt(v[4],10)}D=t?parseFloat(t):D;F=z?parseFloat(z):
F;var x={width:D,height:F};l.gradientDefs=l.getGradientDefs(h);l.cssRules=d(h);l.parseElements(w,function(p){l.documentParsingTime=new Date-q;n&&n(p,x)},b(x))}}}}();r(l,{parseAttributes:function(f,c){if(f){var h,n,q={};if(f.parentNode&&/^g$/i.test(f.parentNode.nodeName))q=l.parseAttributes(f.parentNode,c);var w=c.reduce(function(v,t){h=f.getAttribute(t);n=parseFloat(h);if(h){if((t==="fill"||t==="stroke")&&h==="none")h="";if(t==="fill-rule")h=h==="evenodd"?"destination-over":h;if(t==="transform")h=
l.parseTransformAttribute(h);if(t in g)t=g[t];v[t]=isNaN(n)?h:n}return v},{});w=r(w,r(k(f),l.parseStyleAttribute(f)));return r(q,w)}},parseElements:function(f,c,h){function n(){if(--w===0){q=q.filter(function(x){return x!=null});m(q);c(q)}}for(var q=Array(f.length),w=f.length,v=0,t,z=f.length;v<z;v++){t=f[v];var D=l[u(t.tagName)];if(D&&D.fromElement)try{if(D.fromElement.async)D.fromElement(t,function(x){return function(p){q.splice(x,0,p);n()}}(v),h);else{q.splice(v,0,D.fromElement(t,h));n()}}catch(F){l.log(F.message||
F)}else n()}},parseStyleAttribute:function(f){var c={};if(f=f.getAttribute("style"))if(typeof f=="string"){f=f.replace(/;$/,"").split(";");c=f.reduce(function(n,q){var w=q.split(":"),v=w[0].trim();w=w[1].trim();n[v]=w;return n},{})}else for(var h in f)if(typeof f[h]!=="undefined")c[h]=f[h];return c},parsePointsAttribute:function(f){if(!f)return null;f=f.trim();var c=f.indexOf(",")>-1;f=f.split(/\s+/);var h=[];if(c){c=0;for(var n=f.length;c<n;c++){var q=f[c].split(",");h.push({x:parseFloat(q[0]),y:parseFloat(q[1])})}}else{c=
0;for(n=f.length;c<n;c+=2)h.push({x:parseFloat(f[c]),y:parseFloat(f[c+1])})}return h},getCSSRules:d})})(this);
(function(){function A(m,d){for(var k in d){if(typeof d[k]==="string"&&/^\d+%$/.test(d[k])){var l=parseFloat(d[k],10);if(k==="x1"||k==="x2")d[k]=m.width*l/100;else if(k==="y1"||k==="y2")d[k]=m.height*l/100}if(k==="x1"||k==="x2")d[k]-=m.width/2;else if(k==="y1"||k==="y2")d[k]-=m.height/2}}fabric.Gradient={create:function(m,d){d||(d={});var k=d.colorStops,l=m.createLinearGradient(d.x1||0,d.y1||0,d.x2||m.canvas.width,d.y2||0);for(var r in k){var u=k[r];l.addColorStop(parseFloat(r),u)}return l},fromElement:function(m,
d,k){for(var l=m.getElementsByTagName("stop"),r,u={},b=l.length;b--;){m=l[b];r=parseInt(m.getAttribute("offset"),10)/100;var g=u;r=r;var f;a:{var c=m.getAttribute("style");if(c){c=c.split(/\s*;\s*/);for(var h=c.length;h--;){var n=c[h].split(/\s*:\s*/),q=n[0].trim();n=n[1].trim();if(q==="stop-color"){f=n;break a}}}}g[r]=f||m.getAttribute("stop-color")}m={x1:m.getAttribute("x1")||0,y1:m.getAttribute("y1")||0,x2:m.getAttribute("x2")||"100%",y2:m.getAttribute("y2")||0};A(k,m);return fabric.Gradient.create(d,
{x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,colorStops:u})},forObject:function(m,d,k){k||(k={});A(m,k);return fabric.Gradient.create(d,{x1:k.x1-m.width/2,y1:k.y1-m.height/2,x2:k.x2-m.width/2,y2:k.y2-m.height/2,colorStops:k.colorStops})}};fabric.getGradientDefs=function(m){var d=m.getElementsByTagName("linearGradient");m=m.getElementsByTagName("radialGradient");for(var k,l={},r=d.length;r--;){k=d[r];l[k.id]=k}for(r=m.length;r--;){k=m[r];l[k.id]=k}return l}})();
(function(A){function m(d,k){arguments.length>0&&this.init(d,k)}A=A.fabric||(A.fabric={});if(A.Point)A.warn("fabric.Point is already defined");else{A.Point=m;m.prototype={constructor:m,init:function(d,k){this.x=d;this.y=k},add:function(d){return new m(this.x+d.x,this.y+d.y)},addEquals:function(d){this.x+=d.x;this.y+=d.y;return this},scalarAdd:function(d){return new m(this.x+d,this.y+d)},scalarAddEquals:function(d){this.x+=d;this.y+=d;return this},subtract:function(d){return new m(this.x-d.x,this.y-
d.y)},subtractEquals:function(d){this.x-=d.x;this.y-=d.y;return this},scalarSubtract:function(d){return new m(this.x-d,this.y-d)},scalarSubtractEquals:function(d){this.x-=d;this.y-=d;return this},multiply:function(d){return new m(this.x*d,this.y*d)},multiplyEquals:function(d){this.x*=d;this.y*=d;return this},divide:function(d){return new m(this.x/d,this.y/d)},divideEquals:function(d){this.x/=d;this.y/=d;return this},eq:function(d){return this.x==d.x&&this.y==d.y},lt:function(d){return this.x<d.x&&
this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,k){return new m(this.x+(d.x-this.x)*k,this.y+(d.y-this.y)*k)},distanceFrom:function(d){var k=this.x-d.x;d=this.y-d.y;return Math.sqrt(k*k+d*d)},min:function(d){return new m(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new m(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},
setXY:function(d,k){this.x=d;this.y=k},setFromPoint:function(d){this.x=d.x;this.y=d.y},swap:function(d){var k=this.x,l=this.y;this.x=d.x;this.y=d.y;d.x=k;d.y=l}}}})(this);
(function(A){function m(k){arguments.length>0&&this.init(k)}var d=A.fabric||(A.fabric={});if(d.Intersection)d.warn("fabric.Intersection is already defined");else{d.Intersection=m;d.Intersection.prototype={init:function(k){this.status=k;this.points=[]},appendPoint:function(k){this.points.push(k)},appendPoints:function(k){this.points=this.points.concat(k)}};d.Intersection.intersectLineLine=function(k,l,r,u){var b,g=(u.x-r.x)*(k.y-r.y)-(u.y-r.y)*(k.x-r.x);b=(l.x-k.x)*(k.y-r.y)-(l.y-k.y)*(k.x-r.x);r=
(u.y-r.y)*(l.x-k.x)-(u.x-r.x)*(l.y-k.y);if(r!=0){g=g/r;b=b/r;if(0<=g&&g<=1&&0<=b&&b<=1){b=new m("Intersection");b.points.push(new d.Point(k.x+g*(l.x-k.x),k.y+g*(l.y-k.y)))}else b=new m("No Intersection")}else b=g==0||b==0?new m("Coincident"):new m("Parallel");return b};d.Intersection.intersectLinePolygon=function(k,l,r){for(var u=new m("No Intersection"),b=r.length,g=0;g<b;g++){var f=m.intersectLineLine(k,l,r[g],r[(g+1)%b]);u.appendPoints(f.points)}if(u.points.length>0)u.status="Intersection";return u};
d.Intersection.intersectPolygonPolygon=function(k,l){for(var r=new m("No Intersection"),u=k.length,b=0;b<u;b++){var g=m.intersectLinePolygon(k[b],k[(b+1)%u],l);r.appendPoints(g.points)}if(r.points.length>0)r.status="Intersection";return r};d.Intersection.intersectPolygonRectangle=function(k,l,r){var u=l.min(r),b=l.max(r);r=new d.Point(b.x,u.y);var g=new d.Point(u.x,b.y);l=m.intersectLinePolygon(u,r,k);r=m.intersectLinePolygon(r,b,k);b=m.intersectLinePolygon(b,g,k);k=m.intersectLinePolygon(g,u,k);
u=new m("No Intersection");u.appendPoints(l.points);u.appendPoints(r.points);u.appendPoints(b.points);u.appendPoints(k.points);if(u.points.length>0)u.status="Intersection";return u}}})(this);
(function(A){function m(d){d?this._tryParsingColor(d):this.setSource([0,0,0,1])}A=A.fabric||(A.fabric={});if(A.Color)A.warn("fabric.Color is already defined.");else{A.Color=m;A.Color.prototype={_tryParsingColor:function(d){var k=m.sourceFromHex(d);k||(k=m.sourceFromRgb(d));k&&this.setSource(k)},getSource:function(){return this._source},setSource:function(d){this._source=d},toRgb:function(){var d=this.getSource();return"rgb("+d[0]+","+d[1]+","+d[2]+")"},toRgba:function(){var d=this.getSource();return"rgba("+
d[0]+","+d[1]+","+d[2]+","+d[3]+")"},toHex:function(){var d=this.getSource(),k=d[0].toString(16);k=k.length==1?"0"+k:k;var l=d[1].toString(16);l=l.length==1?"0"+l:l;d=d[2].toString(16);d=d.length==1?"0"+d:d;return k.toUpperCase()+l.toUpperCase()+d.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(d){var k=this.getSource();k[3]=d;this.setSource(k);return this},toGrayscale:function(){var d=this.getSource(),k=parseInt((d[0]*0.3+d[1]*0.59+d[2]*0.11).toFixed(0),10);this.setSource([k,
k,k,d[3]]);return this},toBlackWhite:function(d){var k=this.getSource(),l=(k[0]*0.3+k[1]*0.59+k[2]*0.11).toFixed(0);k=k[3];d=d||127;l=Number(l)<Number(d)?0:255;this.setSource([l,l,l,k]);return this},overlayWith:function(d){d instanceof m||(d=new m(d));var k=[],l=this.getAlpha(),r=this.getSource();d=d.getSource();for(var u=0;u<3;u++)k.push(Math.round(r[u]*0.5+d[u]*0.5));k[4]=l;this.setSource(k);return this}};A.Color.reRGBa=/^rgba?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(?:\s*,\s*(\d+(?:\.\d+)?))?\)$/;
A.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i;A.Color.fromRgb=function(d){return m.fromSource(m.sourceFromRgb(d))};A.Color.sourceFromRgb=function(d){if(d=d.match(m.reRGBa))return[parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),d[4]?parseFloat(d[4]):1]};A.Color.fromRgba=m.fromRgb;A.Color.fromHex=function(d){return m.fromSource(m.sourceFromHex(d))};A.Color.sourceFromHex=function(d){if(d.match(m.reHex)){var k=d.slice(d.indexOf("#")+1),l=k.length===3;d=l?k.charAt(0)+k.charAt(0):k.substring(0,2);
var r=l?k.charAt(1)+k.charAt(1):k.substring(2,4);k=l?k.charAt(2)+k.charAt(2):k.substring(4,6);return[parseInt(d,16),parseInt(r,16),parseInt(k,16),1]}};A.Color.fromSource=function(d){var k=new m;k.setSource(d);return k}}})(this);
(function(A){if(fabric.Element)fabric.warn("fabric.Element is already defined.");else{var m=A.window,d=m.document,k=fabric.util.object.extend,l=fabric.util.string.capitalize,r=fabric.util.string.camelize,u=fabric.util.fireEvent,b=fabric.util.getPointer,g=fabric.util.getElementOffset,f=fabric.util.removeFromArray,c=fabric.util.addListener,h=fabric.util.removeListener,n=fabric.util.array.min,q=fabric.util.array.max,w=Math.sqrt,v=Math.pow,t=Math.atan2,z=Math.abs,D=Math.min,F=Math.max,x=Error("Could not initialize `canvas` element"),
p={tr:"ne-resize",br:"se-resize",bl:"sw-resize",tl:"nw-resize",ml:"w-resize",mt:"n-resize",mr:"e-resize",mb:"s-resize"};fabric.Element=function(a,e){e||(e={});this._groupSelector=null;this._objects=[];this._activeGroup=this._currentTransform=this._element=this._context=null;this._freeDrawingXPoints=[];this._freeDrawingYPoints=[];this._createUpperCanvas(a);this._initOptions(e);this._initWrapperElement();this._createLowerCanvas();this._initEvents();e.overlayImage&&this.setOverlayImage(e.overlayImage);
this.calcOffset();fabric.Element.activeInstance=this};k(fabric.Element.prototype,{backgroundColor:"rgba(0, 0, 0, 0)",selectionColor:"rgba(100, 100, 255, 0.3)",selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,freeDrawingColor:"rgb(0, 0, 0)",freeDrawingLineWidth:1,includeDefaultValues:true,shouldCacheImages:false,stateful:true,renderOnAddition:true,CANVAS_WIDTH:600,CANVAS_HEIGHT:600,CONTAINER_CLASS:"canvas-container",onBeforeScaleRotate:function(){},onFpsUpdate:null,calcOffset:function(){this._offset=
g(this._element);return this},setOverlayImage:function(a,e){if(a){var o=this,s=new Image;s.onload=function(){o.overlayImage=s;e&&e();s=s.onload=null};s.src=a}return this},_initWrapperElement:function(){this._wrapper=fabric.util.wrapElement(this._element,"div",{"class":this.CONTAINER_CLASS});fabric.util.setStyle(this._wrapper,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});fabric.util.makeElementUnselectable(this._wrapper)},_applyCanvasStyle:function(a){fabric.util.setStyle(a,
{position:"absolute",width:this.getWidth()+"px",height:this.getHeight()+"px",left:0,top:0});a.width=this.getWidth()||a.width;a.height=this.getHeight()||a.height;fabric.util.makeElementUnselectable(a)},_createCanvasElement:function(){var a=d.createElement("canvas");if(!a)throw x;typeof a.getContext==="undefined"&&typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(a);if(typeof a.getContext==="undefined")throw x;return a},_initOptions:function(a){for(var e in a)this[e]=a[e];this.width=
parseInt(this._element.width,10)||0;this.height=parseInt(this._element.height,10)||0;this._element.style.width=this.width+"px";this._element.style.height=this.height+"px"},_initEvents:function(){var a=this;this._onMouseDown=function(e){a.__onMouseDown(e)};this._onMouseUp=function(e){a.__onMouseUp(e)};this._onMouseMove=function(e){a.__onMouseMove(e)};this._onResize=function(){a.calcOffset()};c(this._element,"mousedown",this._onMouseDown);c(d,"mousemove",this._onMouseMove);c(d,"mouseup",this._onMouseUp);
c(m,"resize",this._onResize)},_createUpperCanvas:function(a){this._element=fabric.util.getById(a)||this._createCanvasElement();fabric.util.addClass(this._element,"upper-canvas");this._applyCanvasStyle(this._element);this.contextTop=this._element.getContext("2d")},_createLowerCanvas:function(){this.lowerCanvasEl=this._createCanvasElement();this.lowerCanvasEl.className="lower-canvas";this._wrapper.insertBefore(this.lowerCanvasEl,this._element);this._applyCanvasStyle(this.lowerCanvasEl);this.contextContainer=
this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a){return this._setDimension("width",a)},setHeight:function(a){return this._setDimension("height",a)},setDimensions:function(a){for(var e in a)this._setDimension(e,a[e]);return this},_setDimension:function(a,e){this.lowerCanvasEl[a]=e;this.lowerCanvasEl.style[a]=e+"px";this._element[a]=e;this._element.style[a]=e+"px";this._wrapper.style[a]=e+"px";this[a]=e;this.calcOffset();
this.renderAll();return this},__onMouseUp:function(a){if(this.isDrawingMode&&this._isCurrentlyDrawing)this._finalizeDrawingPath();else{if(this._currentTransform){var e=this._currentTransform.target;if(e._scaling){u("object:scaled",{target:e});e._scaling=false}for(var o=this._objects.length;o--;)this._objects[o].setCoords();if(this.stateful&&e.hasStateChanged()){e.isMoving=false;u("object:modified",{target:e})}}this._currentTransform=null;this._groupSelector&&this._findSelectedObjects(a);if(o=this.getActiveGroup()){this.stateful&&
o.hasStateChanged()&&o.containsPoint(this.getPointer(a))&&u("group:modified",{target:o});o.setObjectsCoords();o.set("isMoving",false);this._setCursor("default")}this._groupSelector=null;this.renderAll();this._setCursorFromEvent(a,e);this._setCursor("");var s=this;setTimeout(function(){s._setCursorFromEvent(a,e)},50);u("mouse:up")}},_shouldClearSelection:function(a){var e=this.findTarget(a),o=this.getActiveGroup();return!e||e&&o&&!o.contains(e)&&o!==e&&!a.shiftKey},__onMouseDown:function(a){if(this.isDrawingMode){this._prepareForDrawing(a);
this._captureDrawingPath(a)}else if(!this._currentTransform){var e=this.findTarget(a),o=this.getPointer(a),s=this.getActiveGroup();if(this._shouldClearSelection(a)){this._groupSelector={ex:o.x,ey:o.y,top:0,left:0};this.deactivateAllWithDispatch()}else{this.stateful&&e.saveState();e._findTargetCorner(a,this._offset)&&this.onBeforeScaleRotate(e);this._setupCurrentTransform(a,e);if(a.shiftKey&&(s||this.getActiveObject()))this._handleGroupLogic(a,e);else{e!==this.getActiveGroup()&&this.deactivateAll();
this.setActiveObject(e)}}this.renderAll()}},getElement:function(){return this._element},deactivateAllWithDispatch:function(){var a=this.getActiveGroup();a&&u("before:group:destroyed",{target:a});this.deactivateAll();a&&u("after:group:destroyed");u("selection:cleared");return this},_setupCurrentTransform:function(a,e){var o="drag",s,y=b(a);if(s=e._findTargetCorner(a,this._offset))o=s==="ml"||s==="mr"?"scaleX":s==="mt"||s==="mb"?"scaleY":"rotate";this._currentTransform={target:e,action:o,scaleX:e.scaleX,
scaleY:e.scaleY,offsetX:y.x-e.left,offsetY:y.y-e.top,ex:y.x,ey:y.y,left:e.left,top:e.top,theta:e.theta,width:e.width*e.scaleX};this._currentTransform.original={left:e.left,top:e.top}},_handleGroupLogic:function(a,e){if(e.isType("group")){e=this.findTarget(a,true);if(!e||e.isType("group"))return}var o=this.getActiveGroup();if(o){if(o.contains(e)){o.remove(e);e.setActive(false);o.size()===1&&this.removeActiveGroup()}else o.add(e);u("group:selected",{target:o});o.setActive(true)}else{if(this._activeObject)if(e!==
this._activeObject){this.setActiveGroup(new fabric.Group([this._activeObject,e]));o=this.getActiveGroup()}e.setActive(true)}o&&o.saveCoords()},_prepareForDrawing:function(a){this._isCurrentlyDrawing=true;this.removeActiveObject().renderAll();a=this.getPointer(a);this._freeDrawingXPoints.length=this._freeDrawingYPoints.length=0;this._freeDrawingXPoints.push(a.x);this._freeDrawingYPoints.push(a.y);this.contextTop.beginPath();this.contextTop.moveTo(a.x,a.y);this.contextTop.strokeStyle=this.freeDrawingColor;
this.contextTop.lineWidth=this.freeDrawingLineWidth;this.contextTop.lineCap=this.contextTop.lineJoin="round"},_captureDrawingPath:function(a){a=this.getPointer(a);this._freeDrawingXPoints.push(a.x);this._freeDrawingYPoints.push(a.y);this.contextTop.lineTo(a.x,a.y);this.contextTop.stroke()},_finalizeDrawingPath:function(){this.contextTop.closePath();this._isCurrentlyDrawing=false;var a=n(this._freeDrawingXPoints),e=n(this._freeDrawingYPoints),o=q(this._freeDrawingXPoints),s=q(this._freeDrawingYPoints),
y=[],C,B,E=this._freeDrawingXPoints,G=this._freeDrawingYPoints;y.push("M ",E[0]-a," ",G[0]-e," ");for(var H=1;C=E[H],B=G[H];H++)y.push("L ",C-a," ",B-e," ");y=y.join("");if(y!=="M 0 0 L 0 0 "){y=new fabric.Path(y);y.fill=null;y.stroke=this.freeDrawingColor;y.strokeWidth=this.freeDrawingLineWidth;this.add(y);y.set("left",a+(o-a)/2).set("top",e+(s-e)/2).setCoords();this.renderAll();u("path:created",{path:y})}},__onMouseMove:function(a){if(this.isDrawingMode)this._isCurrentlyDrawing&&this._captureDrawingPath(a);
else{var e=this._groupSelector;if(e!==null){var o=b(a);e.left=o.x-this._offset.left-e.ex;e.top=o.y-this._offset.top-e.ey;this.renderTop()}else if(this._currentTransform){o=b(a);e=o.x;o=o.y;this._currentTransform.target.isMoving=true;if(this._currentTransform.action==="rotate"){a.shiftKey||this._rotateObject(e,o);this._scaleObject(e,o)}else if(this._currentTransform.action==="scaleX")this._scaleObject(e,o,"x");else if(this._currentTransform.action==="scaleY")this._scaleObject(e,o,"y");else{this._translateObject(e,
o);u("object:moved",{target:this._currentTransform.target})}this.renderAll()}else{o=this._element.style;if(e=this.findTarget(a)){this._setCursorFromEvent(a,e);e.isActive()&&e.setCornersVisibility&&e.setCornersVisibility(true)}else{for(a=this._objects.length;a--;)this._objects[a].active||this._objects[a].setActive(false);o.cursor="default"}}}},_translateObject:function(a,e){var o=this._currentTransform.target;o.lockHorizontally||o.set("left",a-this._currentTransform.offsetX);o.lockVertically||o.set("top",
e-this._currentTransform.offsetY)},_scaleObject:function(a,e,o){var s=this._currentTransform,y=this._offset,C=s.target;if(!C.lockScaling){var B=w(v(s.ey-s.top-y.top,2)+v(s.ex-s.left-y.left,2));a=w(v(e-s.top-y.top,2)+v(a-s.left-y.left,2));C._scaling=true;if(o)if(o==="x")C.set("scaleX",s.scaleX*a/B);else o==="y"&&C.set("scaleY",s.scaleY*a/B);else{C.set("scaleX",s.scaleX*a/B);C.set("scaleY",s.scaleY*a/B)}}},_rotateObject:function(a,e){var o=this._currentTransform,s=this._offset;if(!o.target.lockRotation){var y=
t(o.ey-o.top-s.top,o.ex-o.left-s.left);s=t(e-o.top-s.top,a-o.left-s.left);o.target.set("theta",s-y+o.theta)}},_setCursor:function(a){this._element.style.cursor=a},_setCursorFromEvent:function(a,e){var o=this._element.style;if(e){var s=this.getActiveGroup();if(s=!!e._findTargetCorner&&(!s||!s.contains(e))&&e._findTargetCorner(a,this._offset))if(s in p)o.cursor=p[s];else{o.cursor="default";return false}else o.cursor="move"}else{o.cursor="default";return false}return true},_draw:function(a,e){e&&e.render(a)},
_drawSelection:function(){var a=this._groupSelector,e=a.left,o=a.top,s=z(e),y=z(o);this.contextTop.fillStyle=this.selectionColor;this.contextTop.fillRect(a.ex-(e>0?0:-e),a.ey-(o>0?0:-o),s,y);this.contextTop.lineWidth=this.selectionLineWidth;this.contextTop.strokeStyle=this.selectionBorderColor;this.contextTop.strokeRect(a.ex+0.5-(e>0?0:s),a.ey+0.5-(o>0?0:y),s,y)},_findSelectedObjects:function(){var a=[],e=this._groupSelector.ex,o=this._groupSelector.ey,s=e+this._groupSelector.left,y=o+this._groupSelector.top,
C=new fabric.Point(D(e,s),D(o,y));o=new fabric.Point(F(e,s),F(o,y));s=0;for(y=this._objects.length;s<y;++s){e=this._objects[s];if(e.intersectsWithRect(C,o)||e.isContainedWithinRect(C,o)){e.setActive(true);a.push(e)}}if(a.length===1){this.setActiveObject(a[0]);u("object:selected",{target:a[0]})}else if(a.length>1){a=new fabric.Group(a);this.setActiveGroup(a);a.saveCoords();u("group:selected",{target:a})}this.renderAll()},add:function(){this._objects.push.apply(this._objects,arguments);for(var a=arguments.length;a--;){this.stateful&&
arguments[a].setupState();arguments[a].setCoords()}this.renderOnAddition&&this.renderAll();return this},insertAt:function(a,e){this._objects.splice(e,0,a);this.stateful&&a.setupState();a.setCoords();this.renderAll();return this},getObjects:function(){return this._objects},getContext:function(){return this.contextTop},clearContext:function(a){a.clearRect(0,0,this.width,this.height);return this},clear:function(){this._objects.length=0;this.clearContext(this.contextTop);this.clearContext(this.contextContainer);
this.renderAll();return this},renderAll:function(a){var e=this[a?"contextTop":"contextContainer"];this.clearContext(this.contextTop);a||this.clearContext(e);e.fillStyle=this.backgroundColor;e.fillRect(0,0,this.width,this.height);a=this._objects.length;var o=this.getActiveGroup(),s=new Date;if(a)for(var y=0;y<a;++y)if(!o||o&&!o.contains(this._objects[y]))this._draw(e,this._objects[y]);o&&this._draw(this.contextTop,o);this.overlayImage&&this.contextTop.drawImage(this.overlayImage,0,0);this.onFpsUpdate&&
this.onFpsUpdate(~~(1E3/(new Date-s)));u("after:render");return this},renderTop:function(){this.clearContext(this.contextTop);this.overlayImage&&this.contextTop.drawImage(this.overlayImage,0,0);this._groupSelector&&this._drawSelection();var a=this.getActiveGroup();a&&a.render(this.contextTop);u("after:render");return this},containsPoint:function(a,e){var o=this.getPointer(a),s=this._normalizePointer(e,o);o=s.x;s=s.y;var y=e._getImageLines(e.oCoords);if((o=e._findCrossPoints(o,s,y))&&o%2===1||e._findTargetCorner(a,
this._offset))return true;return false},_normalizePointer:function(a,e){var o=this.getActiveGroup(),s=e.x,y=e.y;if(o&&a.type!=="group"&&o.contains(a)){s-=o.left;y-=o.top}return{x:s,y:y}},findTarget:function(a,e){var o;this.getPointer(a);var s=this.getActiveGroup();if(s&&!e&&this.containsPoint(a,s))return o=s;for(s=this._objects.length;s--;)if(this.containsPoint(a,this._objects[s])){this.relatedTarget=o=this._objects[s];break}return o},toDataURL:function(a){var e;a||(a="png");if(a==="jpeg"||a==="png"){this.renderAll(true);
e=this._element.toDataURL("image/"+a);this.renderAll()}return e},toDataURLWithMultiplier:function(a,e){var o=this.getWidth(),s=this.getHeight(),y=o*e,C=s*e,B=this.getActiveObject();this.setWidth(y).setHeight(C);this.contextTop.scale(e,e);B&&this.deactivateAll().renderAll();y=this.toDataURL(a);this.contextTop.scale(1/e,1/e);this.setWidth(o).setHeight(s);B&&this.setActiveObject(B);this.renderAll();return y},getPointer:function(a){a=b(a);return{x:a.x-this._offset.left,y:a.y-this._offset.top}},getCenter:function(){return{top:this.getHeight()/
2,left:this.getWidth()/2}},centerObjectH:function(a){a.set("left",this.getCenter().left);this.renderAll();return this},fxCenterObjectH:function(a,e){e=e||{};var o=function(){},s=e.onComplete||o,y=e.onChange||o,C=this;fabric.util.animate({startValue:a.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(B){a.set("left",B);C.renderAll();y()},onComplete:function(){a.setCoords();s()}});return this},centerObjectV:function(a){a.set("top",this.getCenter().top);this.renderAll();
return this},fxCenterObjectV:function(a,e){e=e||{};var o=function(){},s=e.onComplete||o,y=e.onChange||o,C=this;fabric.util.animate({startValue:a.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(B){a.set("top",B);C.renderAll();y()},onComplete:function(){a.setCoords();s()}});return this},straightenObject:function(a){a.straighten();this.renderAll();return this},fxStraightenObject:function(a){a.fxStraighten({onChange:this.renderAll.bind(this)});return this},toDatalessJSON:function(){return this.toDatalessObject()},
toObject:function(){return this._toObjectMethod("toObject")},toDatalessObject:function(){return this._toObjectMethod("toDatalessObject")},_toObjectMethod:function(a){return{objects:this._objects.map(function(e){if(!this.includeDefaultValues){var o=e.includeDefaultValues;e.includeDefaultValues=false}var s=e[a]();if(!this.includeDefaultValues)e.includeDefaultValues=o;return s},this),background:this.backgroundColor}},isEmpty:function(){return this._objects.length===0},loadFromJSON:function(a,e){if(a){var o=
JSON.parse(a);if(!(!o||o&&!o.objects)){this.clear();var s=this;this._enlivenObjects(o.objects,function(){s.backgroundColor=o.background;e&&e()});return this}}},_enlivenObjects:function(a,e){var o=0,s=a.filter(function(C){return C.type==="image"}).length,y=this;a.forEach(function(C,B){if(C.type)switch(C.type){case "image":case "font":fabric[l(C.type)].fromObject(C,function(G){y.insertAt(G,B);++o===s&&e&&e()});break;default:var E=fabric[r(l(C.type))];E&&E.fromObject&&y.insertAt(E.fromObject(C),B);break}});
s===0&&e&&e()},loadFromDatalessJSON:function(a,e){if(a){var o=typeof a==="string"?JSON.parse(a):a;if(!(!o||o&&!o.objects)){this.clear();this.backgroundColor=o.background;this._enlivenDatalessObjects(o.objects,e)}}},_enlivenDatalessObjects:function(a,e){function o(E,G){s.insertAt(E,G);E.setCoords();++y===C&&e&&e()}var s=this,y=0,C=a.length;C===0&&e&&e();try{a.forEach(function(E,G){var H=E.paths?"paths":"path",K=E[H];delete E[H];if(typeof K!=="string")switch(E.type){case "image":case "text":fabric[l(E.type)].fromObject(E,
function(I){o(I,G)});break;default:var J=fabric[r(l(E.type))];if(J&&J.fromObject){if(K)E[H]=K;o(J.fromObject(E),G)}break}else if(E.type==="image")s.loadImageFromURL(K,function(I){I.setSourcePath(K);k(I,E);I.setAngle(E.angle);o(I,G)});else if(E.type==="text"){E.path=K;var N=fabric.Text.fromObject(E);fabric.util.getScript(K,function(){Object.prototype.toString.call(m.opera)==="[object Opera]"?setTimeout(function(){o(N,G)},500):o(N,G)})}else s.loadSVGFromURL(K,function(I){I=I.length>1?new fabric.PathGroup(I,
E):I[0];I.setSourcePath(K);if(!(I instanceof fabric.PathGroup)){k(I,E);typeof E.angle!=="undefined"&&I.setAngle(E.angle)}o(I,G)})},this)}catch(B){fabric.log(B.message)}},loadImageFromURL:function(){var a={};return function(e,o){function s(){var C=d.getElementById(a[e]);C.width&&C.height?o(new fabric.Image(C)):setTimeout(s,50)}if(a[e])s();else{var y=new Image;y.onload=function(){y.onload=null;y.width&&y.height&&o(new fabric.Image(y))};y.className="canvas-img-clone";y.src=e;if(this.shouldCacheImages)a[e]=
Element.identify(y);d.body.appendChild(y)}}}(),loadSVGFromURL:function(a,e){function o(y){if(y=y.responseXML)(y=y.documentElement)&&fabric.parseSVGDocument(y,function(C,B){s.cache.set(a,{objects:fabric.util.array.invoke(C,"toObject"),options:B});e(C,B)})}var s=this;a=a.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim();this.cache.has(a,function(y){if(y)s.cache.get(a,function(C){C=s._enlivenCachedObject(C);e(C.objects,C.options)});else new fabric.util.request(a,{method:"get",onComplete:o})})},_enlivenCachedObject:function(a){var e=
a.objects;a=a.options;e=e.map(function(o){return fabric[l(o.type)].fromObject(o)});return{objects:e,options:a}},remove:function(a){f(this._objects,a);this.getActiveObject()===a&&this.removeActiveObject();this.renderAll();return a},fxRemove:function(a,e){var o=this;a.fxRemove({onChange:this.renderAll.bind(this),onComplete:function(){o.remove(a);typeof e==="function"&&e()}});return this},sendToBack:function(a){f(this._objects,a);this._objects.unshift(a);return this.renderAll()},bringToFront:function(a){f(this._objects,
a);this._objects.push(a);return this.renderAll()},sendBackwards:function(a){var e=this._objects.indexOf(a),o=e;if(e!==0){for(e=e-1;e>=0;--e)if(a.intersectsWithObject(this._objects[e])){o=e;break}f(this._objects,a);this._objects.splice(o,0,a)}return this.renderAll()},bringForward:function(a){var e=this.getObjects(),o=e.indexOf(a),s=o;if(o!==e.length-1){o=o+1;for(var y=this._objects.length;o<y;++o)if(a.intersectsWithObject(e[o])){s=o;break}f(e,a);e.splice(s,0,a)}this.renderAll()},setActiveObject:function(a){this._activeObject&&
this._activeObject.setActive(false);this._activeObject=a;a.setActive(true);this.renderAll();u("object:selected",{target:a});return this},getActiveObject:function(){return this._activeObject},removeActiveObject:function(){this._activeObject&&this._activeObject.setActive(false);this._activeObject=null;return this},setActiveGroup:function(a){this._activeGroup=a;return this},getActiveGroup:function(){return this._activeGroup},removeActiveGroup:function(){var a=this.getActiveGroup();a&&a.destroy();return this.setActiveGroup(null)},
item:function(a){return this.getObjects()[a]},deactivateAll:function(){for(var a=this.getObjects(),e=0,o=a.length;e<o;e++)a[e].setActive(false);this.removeActiveGroup();this.removeActiveObject();return this},complexity:function(){return this.getObjects().reduce(function(a,e){a+=e.complexity?e.complexity():0;return a},0)},dispose:function(){this.clear();h(this._element,"mousedown",this._onMouseDown);h(d,"mouseup",this._onMouseUp);h(d,"mousemove",this._onMouseMove);h(m,"resize",this._onResize);return this},
clone:function(a){var e=d.createElement("canvas");e.width=this.getWidth();e.height=this.getHeight();var o=this.__clone||(this.__clone=new fabric.Element(e));return o.loadFromJSON(JSON.stringify(this.toJSON()),function(){a&&a(o)})},_toDataURL:function(a,e){this.clone(function(o){e(o.toDataURL(a))})},_toDataURLWithMultiplier:function(a,e,o){this.clone(function(s){o(s.toDataURLWithMultiplier(a,e))})},_resizeImageToFit:function(a){var e=a.width||a.offsetWidth,o=this.getWidth()/e;if(e)a.width=e*o},cache:{has:function(a,
e){e(false)},get:function(){},set:function(){}}});fabric.Element.prototype.toString=function(){return"#<fabric.Element ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"};k(fabric.Element,{EMPTY_JSON:'{"objects": [], "background": "white"}',toGrayscale:function(a){var e=a.getContext("2d");a=e.getImageData(0,0,a.width,a.height);var o=a.data,s=a.width,y=a.height,C,B;for(i=0;i<s;i++)for(j=0;j<y;j++){C=i*4*y+j*4;B=(o[C]+o[C+1]+o[C+2])/3;o[C]=B;o[C+1]=B;o[C+2]=B}e.putImageData(a,0,0)},
supports:function(a){var e=d.createElement("canvas");typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(e);if(!e||!e.getContext)return null;var o=e.getContext("2d");if(!o)return null;switch(a){case "getImageData":return typeof o.getImageData!=="undefined";case "toDataURL":return typeof e.toDataURL!=="undefined";default:return null}}});fabric.Element.prototype.toJSON=fabric.Element.prototype.toObject}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=m.util.toFixed,k=m.util.string.capitalize,l=m.util.getPointer,r=m.util.degreesToRadians,u=Array.prototype.slice;if(!m.Object){m.Object=m.util.createClass({type:"object",includeDefaultValues:true,NUM_FRACTION_DIGITS:2,FX_DURATION:500,FX_TRANSITION:"decel",MIN_SCALE_LIMIT:0.1,stateProperties:"top left width height scaleX scaleY flipX flipY theta angle opacity cornersize fill overlayFill stroke strokeWidth fillRule borderScaleFactor transformMatrix".split(" "),
top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:false,flipY:false,theta:0,opacity:1,angle:0,cornersize:12,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",fill:"rgb(0,0,0)",fillRule:"source-over",overlayFill:null,stroke:null,strokeWidth:1,borderOpacityWhenMoving:0.4,borderScaleFactor:1,transformMatrix:null,callSuper:function(b){var g=this.constructor.superclass.prototype[b];return arguments.length>1?g.apply(this,u.call(arguments,1)):g.call(this)},initialize:function(b){b&&
this.setOptions(b)},setOptions:function(b){for(var g=this.stateProperties.length,f;g--;){f=this.stateProperties[g];if(f in b)f==="angle"?this.setAngle(b[f]):this[f]=b[f]}},transform:function(b){b.globalAlpha=this.opacity;b.translate(this.left,this.top);b.rotate(this.theta);b.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(){var b={type:this.type,left:d(this.left,this.NUM_FRACTION_DIGITS),top:d(this.top,this.NUM_FRACTION_DIGITS),width:d(this.width,this.NUM_FRACTION_DIGITS),
height:d(this.height,this.NUM_FRACTION_DIGITS),fill:this.fill,overlayFill:this.overlayFill,stroke:this.stroke,strokeWidth:this.strokeWidth,scaleX:d(this.scaleX,this.NUM_FRACTION_DIGITS),scaleY:d(this.scaleY,this.NUM_FRACTION_DIGITS),angle:d(this.getAngle(),this.NUM_FRACTION_DIGITS),flipX:this.flipX,flipY:this.flipY,opacity:d(this.opacity,this.NUM_FRACTION_DIGITS)};this.includeDefaultValues||(b=this._removeDefaultValues(b));return b},toDatalessObject:function(){return this.toObject()},_removeDefaultValues:function(b){var g=
m.Object.prototype.options;this.stateProperties.forEach(function(f){b[f]===g[f]&&delete b[f]});return b},isActive:function(){return!!this.active},setActive:function(b){this.active=!!b;return this},toString:function(){return"#<fabric."+k(this.type)+">"},set:function(b,g){if((b==="scaleX"||b==="scaleY")&&g<this.MIN_SCALE_LIMIT)g=this.MIN_SCALE_LIMIT;if(b==="angle")this.setAngle(g);else this[b]=g;return this},toggle:function(b){var g=this.get(b);typeof g==="boolean"&&this.set(b,!g);return this},setSourcePath:function(b){this.sourcePath=
b;return this},get:function(b){return b==="angle"?this.getAngle():this[b]},render:function(b,g){if(!(this.width===0||this.height===0)){b.save();var f=this.transformMatrix;f&&b.setTransform(f[0],f[1],f[2],f[3],f[4],f[5]);g||this.transform(b);if(this.stroke){b.lineWidth=this.strokeWidth;b.strokeStyle=this.stroke}if(this.overlayFill)b.fillStyle=this.overlayFill;else if(this.fill)b.fillStyle=this.fill;this._render(b,g);if(this.active&&!g){this.drawBorders(b);this.hideCorners||this.drawCorners(b)}b.restore()}},
getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},scale:function(b){this.scaleY=this.scaleX=b;return this},scaleToWidth:function(b){return this.scale(b/this.width)},scaleToHeight:function(b){return this.scale(b/this.height)},setOpacity:function(b){this.set("opacity",b);return this},getAngle:function(){return this.theta*180/Math.PI},setAngle:function(b){this.theta=b/180*Math.PI;this.angle=b;return this},setCoords:function(){this.currentWidth=this.width*
this.scaleX;this.currentHeight=this.height*this.scaleY;this._hypotenuse=Math.sqrt(Math.pow(this.currentWidth/2,2)+Math.pow(this.currentHeight/2,2));this._angle=Math.atan(this.currentHeight/this.currentWidth);var b=Math.cos(this._angle+this.theta)*this._hypotenuse,g=Math.sin(this._angle+this.theta)*this._hypotenuse,f=this.theta,c=Math.sin(f);f=Math.cos(f);b={x:this.left-b,y:this.top-g};g={x:b.x+this.currentWidth*f,y:b.y+this.currentWidth*c};var h={x:b.x-this.currentHeight*c,y:b.y+this.currentHeight*
f};this.oCoords={tl:b,tr:g,br:{x:g.x-this.currentHeight*c,y:g.y+this.currentHeight*f},bl:h,ml:{x:b.x-this.currentHeight/2*c,y:b.y+this.currentHeight/2*f},mt:{x:b.x+this.currentWidth/2*f,y:b.y+this.currentWidth/2*c},mr:{x:g.x-this.currentHeight/2*c,y:g.y+this.currentHeight/2*f},mb:{x:h.x+this.currentWidth/2*f,y:h.y+this.currentWidth/2*c}};this._setCornerCoords();return this},drawBorders:function(b){var g=this.padding,f=g*2;b.save();b.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;b.strokeStyle=
this.borderColor;var c=1/(this.scaleX<this.MIN_SCALE_LIMIT?this.MIN_SCALE_LIMIT:this.scaleX),h=1/(this.scaleY<this.MIN_SCALE_LIMIT?this.MIN_SCALE_LIMIT:this.scaleY);b.lineWidth=1/this.borderScaleFactor;b.scale(c,h);c=this.getWidth();h=this.getHeight();b.strokeRect(~~(-(c/2)-g)+0.5,~~(-(h/2)-g)+0.5,~~(c+f),~~(h+f));b.restore();return this},drawCorners:function(b){var g=this.cornersize,f=g/2,c=this.padding,h=-(this.width/2),n=-(this.height/2),q=g/this.scaleX,w=g/this.scaleY,v=(c+f)/this.scaleY,t=(c+
f)/this.scaleX,z=(c+f-g)/this.scaleX;c=(c+f-g)/this.scaleY;b.save();b.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;b.fillStyle=this.cornerColor;g=h-t;f=n-v;b.fillRect(g,f,q,w);g=h+this.width-t;f=n-v;b.fillRect(g,f,q,w);g=h-t;f=n+this.height+c;b.fillRect(g,f,q,w);g=h+this.width+z;f=n+this.height+c;b.fillRect(g,f,q,w);g=h+this.width/2-t;f=n-v;b.fillRect(g,f,q,w);g=h+this.width/2-t;f=n+this.height+c;b.fillRect(g,f,q,w);g=h+this.width+z;f=n+this.height/2-v;b.fillRect(g,f,q,w);g=h-t;f=n+this.height/
2-v;b.fillRect(g,f,q,w);b.restore();return this},clone:function(b){if(this.constructor.fromObject)return this.constructor.fromObject(this.toObject(),b);return new m.Object(this.toObject())},cloneAsImage:function(b){if(m.Image){var g=new Image;g.onload=function(){b&&b(new m.Image(g),f);g=g.onload=null};var f={angle:this.get("angle"),flipX:this.get("flipX"),flipY:this.get("flipY")};this.set("angle",0).set("flipX",false).set("flipY",false);g.src=this.toDataURL()}return this},toDataURL:function(){var b=
document.createElement("canvas");b.width=this.getWidth();b.height=this.getHeight();m.util.wrapElement(b,"div");var g=new m.Element(b);g.backgroundColor="transparent";g.renderAll();var f=this.clone();f.left=b.width/2;f.top=b.height/2;f.setActive(false);g.add(f);b=g.toDataURL("png");g.dispose();return b},hasStateChanged:function(){return this.stateProperties.some(function(b){return this[b]!==this.originalState[b]},this)},saveState:function(){this.stateProperties.forEach(function(b){this.originalState[b]=
this.get(b)},this);return this},setupState:function(){this.originalState={};this.saveState()},intersectsWithRect:function(b,g){var f=this.oCoords,c=new m.Point(f.tl.x,f.tl.y),h=new m.Point(f.tr.x,f.tr.y),n=new m.Point(f.bl.x,f.bl.y);f=new m.Point(f.br.x,f.br.y);return m.Intersection.intersectPolygonRectangle([c,h,f,n],b,g).status==="Intersection"},intersectsWithObject:function(b){function g(c){return{tl:new m.Point(c.tl.x,c.tl.y),tr:new m.Point(c.tr.x,c.tr.y),bl:new m.Point(c.bl.x,c.bl.y),br:new m.Point(c.br.x,
c.br.y)}}var f=g(this.oCoords);b=g(b.oCoords);return m.Intersection.intersectPolygonPolygon([f.tl,f.tr,f.br,f.bl],[b.tl,b.tr,b.br,b.bl]).status==="Intersection"},isContainedWithinRect:function(b,g){var f=this.oCoords,c=new m.Point(f.tl.x,f.tl.y),h=new m.Point(f.tr.x,f.tr.y),n=new m.Point(f.bl.x,f.bl.y);new m.Point(f.br.x,f.br.y);return c.x>b.x&&h.x<g.x&&c.y>b.y&&n.y<g.y},isType:function(b){return this.type===b},_findTargetCorner:function(b,g){var f=l(b),c=f.x-g.left;f=f.y-g.top;var h;for(var n in this.oCoords){h=
this._getImageLines(this.oCoords[n].corner,n);h=this._findCrossPoints(c,f,h);if(h%2==1&&h!=0)return this.__corner=n}return false},_findCrossPoints:function(b,g,f){var c,h,n,q=0;for(var w in f){n=f[w];if(!(n.o.y<g&&n.d.y<g))if(!(n.o.y>=g&&n.d.y>=g)){if(n.o.x==n.d.x&&n.o.x>=b)c=n.o.x;else{c=(n.d.y-n.o.y)/(n.d.x-n.o.x);h=g-0*b;n=n.o.y-c*n.o.x;c=-(h-n)/(0-c)}if(c>=b)q+=1;if(q==2)break}}return q},_getImageLines:function(b){return{topline:{o:b.tl,d:b.tr},rightline:{o:b.tr,d:b.br},bottomline:{o:b.br,d:b.bl},
leftline:{o:b.bl,d:b.tl}}},_setCornerCoords:function(){var b=this.oCoords,g=r(45-this.getAngle()),f=Math.sqrt(2*Math.pow(this.cornersize,2))/2,c=f*Math.cos(g);g=f*Math.sin(g);b.tl.corner={tl:{x:b.tl.x-g,y:b.tl.y-c},tr:{x:b.tl.x+c,y:b.tl.y-g},bl:{x:b.tl.x-c,y:b.tl.y+g},br:{x:b.tl.x+g,y:b.tl.y+c}};b.tr.corner={tl:{x:b.tr.x-g,y:b.tr.y-c},tr:{x:b.tr.x+c,y:b.tr.y-g},br:{x:b.tr.x+g,y:b.tr.y+c},bl:{x:b.tr.x-c,y:b.tr.y+g}};b.bl.corner={tl:{x:b.bl.x-g,y:b.bl.y-c},bl:{x:b.bl.x-c,y:b.bl.y+g},br:{x:b.bl.x+g,
y:b.bl.y+c},tr:{x:b.bl.x+c,y:b.bl.y-g}};b.br.corner={tr:{x:b.br.x+c,y:b.br.y-g},bl:{x:b.br.x-c,y:b.br.y+g},br:{x:b.br.x+g,y:b.br.y+c},tl:{x:b.br.x-g,y:b.br.y-c}};b.ml.corner={tl:{x:b.ml.x-g,y:b.ml.y-c},tr:{x:b.ml.x+c,y:b.ml.y-g},bl:{x:b.ml.x-c,y:b.ml.y+g},br:{x:b.ml.x+g,y:b.ml.y+c}};b.mt.corner={tl:{x:b.mt.x-g,y:b.mt.y-c},tr:{x:b.mt.x+c,y:b.mt.y-g},bl:{x:b.mt.x-c,y:b.mt.y+g},br:{x:b.mt.x+g,y:b.mt.y+c}};b.mr.corner={tl:{x:b.mr.x-g,y:b.mr.y-c},tr:{x:b.mr.x+c,y:b.mr.y-g},bl:{x:b.mr.x-c,y:b.mr.y+g},br:{x:b.mr.x+
g,y:b.mr.y+c}};b.mb.corner={tl:{x:b.mb.x-g,y:b.mb.y-c},tr:{x:b.mb.x+c,y:b.mb.y-g},bl:{x:b.mb.x-c,y:b.mb.y+g},br:{x:b.mb.x+g,y:b.mb.y+c}}},toGrayscale:function(){var b=this.get("fill");b&&this.set("overlayFill",(new m.Color(b)).toGrayscale().toRgb());return this},complexity:function(){return 0},getCenter:function(){return{x:this.get("left")+this.width/2,y:this.get("top")+this.height/2}},straighten:function(){this.setAngle(this._getAngleValueForStraighten());return this},fxStraighten:function(b){b=
b||{};var g=function(){},f=b.onComplete||g,c=b.onChange||g,h=this;m.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(n){h.setAngle(n);c()},onComplete:function(){h.setCoords();f()},onStart:function(){h.setActive(false)}});return this},fxRemove:function(b){b||(b={});var g=function(){},f=b.onComplete||g,c=b.onChange||g,h=this;m.util.animate({startValue:this.get("opacity"),endValue:0,duration:this.FX_DURATION,onChange:function(n){h.set("opacity",
n);c()},onComplete:f,onStart:function(){h.setActive(false)}});return this},_getAngleValueForStraighten:function(){var b=this.get("angle");if(b>-225&&b<=-135)return-180;else if(b>-135&&b<=-45)return-90;else if(b>-45&&b<=45)return 0;else if(b>45&&b<=135)return 90;else if(b>135&&b<=225)return 180;else if(b>225&&b<=315)return 270;else if(b>315)return 360;return 0},toJSON:function(){return this.toObject()},setGradientFill:function(b,g){this.set("fill",m.Gradient.forObject(this,b,g))}});m.Object.prototype.rotate=
m.Object.prototype.setAngle}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=m.util.object.extend;if(m.Line)m.warn("fabric.Line is already defined");else{m.Line=m.util.createClass(m.Object,{type:"line",initialize:function(k,l){k||(k=[0,0,0,0]);this.callSuper("initialize",l);this.set("x1",k[0]);this.set("y1",k[1]);this.set("x2",k[2]);this.set("y2",k[3]);this.set("width",this.x2-this.x1||1);this.set("height",this.y2-this.y1||1);this.set("left",this.x1+this.width/2);this.set("top",this.y1+this.height/2)},_render:function(k){k.beginPath();
k.moveTo(-this.width/2,-this.height/2);k.lineTo(this.width/2,this.height/2);var l=k.strokeStyle;k.strokeStyle=k.fillStyle;k.stroke();k.strokeStyle=l},complexity:function(){return 1},toObject:function(){return d(this.callSuper("toObject"),{x1:this.get("x1"),y1:this.get("y1"),x2:this.get("x2"),y2:this.get("y2")})}});m.Line.ATTRIBUTE_NAMES="x1 y1 x2 y2 stroke stroke-width transform".split(" ");m.Line.fromElement=function(k,l){var r=m.parseAttributes(k,m.Line.ATTRIBUTE_NAMES);return new m.Line([r.x1||
0,r.y1||0,r.x2||0,r.y2||0],d(r,l))};m.Line.fromObject=function(k){return new m.Line([k.x1,k.y1,k.x2,k.y2],k)}}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=Math.PI*2,k=m.util.object.extend;if(m.Circle)m.warn("fabric.Circle is already defined.");else{m.Circle=m.util.createClass(m.Object,{type:"circle",initialize:function(l){l=l||{};this.set("radius",l.radius||0);this.callSuper("initialize",l);l=this.get("radius")*2*this.get("scaleX");this.set("width",l).set("height",l)},toObject:function(){return k(this.callSuper("toObject"),{radius:this.get("radius")})},_render:function(l,r){l.beginPath();l.arc(r?this.left:
0,r?this.top:0,this.radius,0,d,false);l.closePath();this.fill&&l.fill();this.stroke&&l.stroke()},complexity:function(){return 1}});m.Circle.ATTRIBUTE_NAMES="cx cy r fill fill-opacity stroke stroke-width transform".split(" ");m.Circle.fromElement=function(l,r){r||(r={});var u=m.parseAttributes(l,m.Circle.ATTRIBUTE_NAMES);if(!("radius"in u&&u.radius>0))throw Error("value of `r` attribute is required and can not be negative");if("left"in u)u.left-=r.width/2||0;if("top"in u)u.top-=r.height/2||0;return new m.Circle(k(u,
r))};m.Circle.fromObject=function(l){return new m.Circle(l)}}})(this);
(function(A){var m=A.fabric||(A.fabric={});if(m.Triangle)m.warn("fabric.Triangle is already defined");else{m.Triangle=m.util.createClass(m.Object,{type:"triangle",initialize:function(d){d=d||{};this.callSuper("initialize",d);this.set("width",d.width||100).set("height",d.height||100)},_render:function(d){var k=this.width/2,l=this.height/2;d.beginPath();d.moveTo(-k,l);d.lineTo(0,-l);d.lineTo(k,l);d.closePath();this.fill&&d.fill();this.stroke&&d.stroke()},complexity:function(){return 1}});m.Triangle.fromObject=
function(d){return new m.Triangle(d)}}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=Math.PI*2,k=m.util.object.extend;if(m.Ellipse)m.warn("fabric.Ellipse is already defined.");else{m.Ellipse=m.util.createClass(m.Object,{type:"ellipse",initialize:function(l){l=l||{};this.callSuper("initialize",l);this.set("rx",l.rx||0);this.set("ry",l.ry||0);this.set("width",this.get("rx")*2);this.set("height",this.get("ry")*2)},toObject:function(){return k(this.callSuper("toObject"),{rx:this.get("rx"),ry:this.get("ry")})},render:function(l,r){if(!(this.rx===
0||this.ry===0))return this.callSuper("render",l,r)},_render:function(l,r){l.beginPath();l.save();l.transform(1,0,0,this.ry/this.rx,0,0);l.arc(r?this.left:0,r?this.top:0,this.rx,0,d,false);l.restore();this.stroke&&l.stroke();this.fill&&l.fill()},complexity:function(){return 1}});m.Ellipse.ATTRIBUTE_NAMES="cx cy rx ry fill fill-opacity stroke stroke-width transform".split(" ");m.Ellipse.fromElement=function(l,r){r||(r={});var u=m.parseAttributes(l,m.Ellipse.ATTRIBUTE_NAMES);if("left"in u)u.left-=r.width/
2||0;if("top"in u)u.top-=r.height/2||0;return new m.Ellipse(k(u,r))};m.Ellipse.fromObject=function(l){return new m.Ellipse(l)}}})(this);
(function(A){var m=A.fabric||(A.fabric={});if(m.Rect)console.warn("fabric.Rect is already defined");else{m.Rect=m.util.createClass(m.Object,{type:"rect",options:{rx:0,ry:0},initialize:function(d){this._initStateProperties();this.callSuper("initialize",d);this._initRxRy()},_initStateProperties:function(){this.stateProperties=this.stateProperties.concat(["rx","ry"])},_initRxRy:function(){if(this.rx&&!this.ry)this.ry=this.rx;else if(this.ry&&!this.rx)this.rx=this.ry},_render:function(d){var k=this.rx||
0,l=this.ry||0,r=-this.width/2,u=-this.height/2,b=this.width,g=this.height;d.beginPath();d.moveTo(r+k,u);d.lineTo(r+b-k,u);d.bezierCurveTo(r+b,u,r+b,u+l,r+b,u+l);d.lineTo(r+b,u+g-l);d.bezierCurveTo(r+b,u+g,r+b-k,u+g,r+b-k,u+g);d.lineTo(r+k,u+g);d.bezierCurveTo(r,u+g,r,u+g-l,r,u+g-l);d.lineTo(r,u+l);d.bezierCurveTo(r,u,r+k,u,r+k,u);d.closePath();this.fill&&d.fill();this.stroke&&d.stroke()},_normalizeLeftTopProperties:function(d){d.left&&this.set("left",d.left+this.getWidth()/2);d.top&&this.set("top",
d.top+this.getHeight()/2);return this},complexity:function(){return 1}});m.Rect.ATTRIBUTE_NAMES="x y width height rx ry fill fill-opacity stroke stroke-width transform".split(" ");m.Rect.fromElement=function(d,k){if(!d)return null;var l=m.parseAttributes(d,m.Rect.ATTRIBUTE_NAMES);l=l;l.left=l.left||0;l.top=l.top||0;l=l;var r=new m.Rect(m.util.object.extend(k||{},l));r._normalizeLeftTopProperties(l);return r};m.Rect.fromObject=function(d){return new m.Rect(d)}}})(this);
(function(A){var m=A.fabric||(A.fabric={});if(m.Polyline)m.warn("fabric.Polyline is already defined");else{m.Polyline=m.util.createClass(m.Object,{type:"polyline",initialize:function(d,k){k=k||{};this.set("points",d);this.callSuper("initialize",k);this._calcDimensions()},_calcDimensions:function(){return m.Polygon.prototype._calcDimensions.call(this)},toObject:function(){return m.Polygon.prototype.toObject.call(this)},_render:function(d){var k;d.beginPath();for(var l=0,r=this.points.length;l<r;l++){k=
this.points[l];d.lineTo(k.x,k.y)}this.fill&&d.fill();this.stroke&&d.stroke()},complexity:function(){return this.get("points").length}});m.Polyline.ATTRIBUTE_NAMES="fill fill-opacity stroke stroke-width transform".split(" ");m.Polyline.fromElement=function(d,k){if(!d)return null;k||(k={});for(var l=m.parsePointsAttribute(d.getAttribute("points")),r=m.parseAttributes(d,m.Polyline.ATTRIBUTE_NAMES),u=0,b=l.length;u<b;u++){l[u].x-=k.width/2||0;l[u].y-=k.height/2||0}return new m.Polyline(l,m.util.object.extend(r,
k))};m.Polyline.fromObject=function(d){return new m.Polyline(d.points,d)}}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=m.util.object.extend,k=m.util.array.min,l=m.util.array.max;if(m.Polygon)m.warn("fabric.Polygon is already defined");else{m.Polygon=m.util.createClass(m.Object,{type:"polygon",initialize:function(r,u){u=u||{};this.points=r;this.callSuper("initialize",u);this._calcDimensions()},_calcDimensions:function(){var r=this.points,u=k(r,"x"),b=k(r,"y"),g=l(r,"x");r=l(r,"y");this.width=g-u;this.height=r-b;this.minX=u;this.minY=b},toObject:function(){return d(this.callSuper("toObject"),
{points:this.points.concat()})},_render:function(r){var u;r.beginPath();for(var b=0,g=this.points.length;b<g;b++){u=this.points[b];r.lineTo(u.x,u.y)}this.fill&&r.fill();if(this.stroke){r.closePath();r.stroke()}},complexity:function(){return this.points.length}});m.Polygon.ATTRIBUTE_NAMES="fill fill-opacity stroke stroke-width transform".split(" ");m.Polygon.fromElement=function(r,u){if(!r)return null;u||(u={});for(var b=m.parsePointsAttribute(r.getAttribute("points")),g=m.parseAttributes(r,m.Polygon.ATTRIBUTE_NAMES),
f=0,c=b.length;f<c;f++){b[f].x-=u.width/2||0;b[f].y-=u.height/2||0}return new m.Polygon(b,d(g,u))};m.Polygon.fromObject=function(r){return new m.Polygon(r.points,r)}}})(this);
(function(A){function m(g){if(g[0]==="H")return g[1];return g[g.length-2]}function d(g){if(g[0]==="V")return g[1];return g[g.length-1]}var k=A.fabric||(A.fabric={}),l=k.util.array.min,r=k.util.array.max,u=k.util.object.extend,b=Object.prototype.toString;if(k.Path)k.warn("fabric.Path is already defined");else if(k.Object){k.Path=k.util.createClass(k.Object,{type:"path",initialize:function(g,f){f=f||{};this.setOptions(f);if(!g)throw Error("`path` argument is required");var c=b.call(g)==="[object Array]";
if(this.path=c?g:g.match&&g.match(/[a-zA-Z][^a-zA-Z]*/g)){c||this._initializeFromArray(f);f.sourcePath&&this.setSourcePath(f.sourcePath)}},_initializeFromArray:function(g){var f="width"in g,c="height"in g;this.path=this._parsePath();if(!f||!c){u(this,this._parseDimensions());if(f)this.width=g.width;if(c)this.height=g.height}},_render:function(g){for(var f,c=0,h=0,n=0,q=0,w,v,t=-(this.width/2),z=-(this.height/2),D=0,F=this.path.length;D<F;++D){f=this.path[D];switch(f[0]){case "l":c+=f[1];h+=f[2];g.lineTo(c+
t,h+z);break;case "L":c=f[1];h=f[2];g.lineTo(c+t,h+z);break;case "h":c+=f[1];g.lineTo(c+t,h+z);break;case "H":c=f[1];g.lineTo(c+t,h+z);break;case "v":h+=f[1];g.lineTo(c+t,h+z);break;case "V":h=f[1];g.lineTo(c+t,h+z);break;case "m":c+=f[1];h+=f[2];g.moveTo(c+t,h+z);break;case "M":c=f[1];h=f[2];g.moveTo(c+t,h+z);break;case "c":w=c+f[5];v=h+f[6];n=c+f[3];q=h+f[4];g.bezierCurveTo(c+f[1]+t,h+f[2]+z,n+t,q+z,w+t,v+z);c=w;h=v;break;case "C":c=f[5];h=f[6];n=f[3];q=f[4];g.bezierCurveTo(f[1]+t,f[2]+z,n+t,q+
z,c+t,h+z);break;case "s":w=c+f[3];v=h+f[4];n=2*c-n;q=2*h-q;g.bezierCurveTo(n+t,q+z,c+f[1]+t,h+f[2]+z,w+t,v+z);c=w;h=v;break;case "S":w=f[3];v=f[4];n=2*c-n;q=2*h-q;g.bezierCurveTo(n+t,q+z,f[1]+t,f[2]+z,w+t,v+z);c=w;h=v;break;case "q":c+=f[3];h+=f[4];g.quadraticCurveTo(f[1]+t,f[2]+z,c+t,h+z);break;case "Q":c=f[3];h=f[4];n=f[1];q=f[2];g.quadraticCurveTo(n+t,q+z,c+t,h+z);break;case "T":w=c;v=h;c=f[1];h=f[2];n=-n+2*w;q=-q+2*v;g.quadraticCurveTo(n+t,q+z,c+t,h+z);break;case "a":break;case "A":break;case "z":case "Z":g.closePath();
break}}},render:function(g,f){g.save();var c=this.transformMatrix;c&&g.transform(c[0],c[1],c[2],c[3],c[4],c[5]);f||this.transform(g);if(this.overlayFill)g.fillStyle=this.overlayFill;else if(this.fill)g.fillStyle=this.fill;if(this.stroke)g.strokeStyle=this.stroke;g.beginPath();this._render(g);this.fill&&g.fill();if(this.stroke){g.strokeStyle=this.stroke;g.lineWidth=this.strokeWidth;g.lineCap=g.lineJoin="round";g.stroke()}if(!f&&this.active){this.drawBorders(g);this.hideCorners||this.drawCorners(g)}g.restore()},
toString:function(){return"#<fabric.Path ("+this.complexity()+"): "+JSON.stringify({top:this.top,left:this.left})+">"},toObject:function(){var g=u(this.callSuper("toObject"),{path:this.path});if(this.sourcePath)g.sourcePath=this.sourcePath;if(this.transformMatrix)g.transformMatrix=this.transformMatrix;return g},toDatalessObject:function(){var g=this.toObject();if(this.sourcePath)g.path=this.sourcePath;delete g.sourcePath;return g},complexity:function(){return this.path.length},_parsePath:function(){for(var g=
[],f,c,h=0,n,q=this.path.length;h<q;h++){f=this.path[h];c=f.slice(1).trim().replace(/(\d)-/g,"$1###-").split(/\s|,|###/);n=c.length;for(f=[f.charAt(0)];n--;)f[n+1]=parseFloat(c[n]);g.push(f)}return g},_parseDimensions:function(){var g=[],f=[],c,h,n=false,q,w;this.path.forEach(function(t,z){if(t[0]!=="H")c=z===0?m(t):m(this.path[z-1]);if(t[0]!=="V")h=z===0?d(t):d(this.path[z-1]);if(t[0]===t[0].toLowerCase())n=true;q=n?c+m(t):t[0]==="V"?c:m(t);w=n?h+d(t):t[0]==="H"?h:d(t);var D=parseInt(q,10);isNaN(D)||
g.push(D);D=parseInt(w,10);isNaN(D)||f.push(D)},this);var v=l(g);v={top:l(f)-0,left:v-0,bottom:r(f)-0,right:r(g)-0};v.width=v.right-v.left;v.height=v.bottom-v.top;return v}});k.Path.fromObject=function(g){return new k.Path(g.path,g)};k.Path.ATTRIBUTE_NAMES="d fill fill-opacity fill-rule stroke stroke-width transform".split(" ");k.Path.fromElement=function(g,f){var c=k.parseAttributes(g,k.Path.ATTRIBUTE_NAMES);return new k.Path(c.d,u(c,f))}}else k.warn("fabric.Path requires fabric.Object")})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=m.util.object.extend,k=m.util.array.invoke,l=m.Object.prototype.set,r=m.Object.prototype.toObject,u=m.util.string.camelize,b=m.util.string.capitalize;if(m.PathGroup)m.warn("fabric.PathGroup is already defined");else{m.PathGroup=m.util.createClass(m.Path,{type:"path-group",forceFillOverwrite:false,initialize:function(g,f){f=f||{};this.paths=g;this.setOptions(f);this.setCoords();f.sourcePath&&this.setSourcePath(f.sourcePath)},render:function(g){if(this.stub){g.save();
this.transform(g);this.stub.render(g,false);if(this.active){this.drawBorders(g);this.drawCorners(g)}}else{g.save();var f=this.transformMatrix;f&&g.transform(f[0],f[1],f[2],f[3],f[4],f[5]);this.transform(g);f=0;for(var c=this.paths.length;f<c;++f)this.paths[f].render(g,true);if(this.active){this.drawBorders(g);this.hideCorners||this.drawCorners(g)}}g.restore()},set:function(g,f){if((g==="fill"||g==="overlayFill")&&this.isSameColor()){this[g]=f;for(var c=this.paths.length;c--;)this.paths[c].set(g,f)}else l.call(this,
g,f);return this},toObject:function(){return d(r.call(this),{paths:k(this.getObjects(),"clone"),sourcePath:this.sourcePath})},toDatalessObject:function(){var g=this.toObject();if(this.sourcePath)g.paths=this.sourcePath;return g},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var g=this.getObjects()[0].get("fill");return this.getObjects().every(function(f){return f.get("fill")===g})},complexity:function(){return this.paths.reduce(function(g,
f){return g+(f&&f.complexity?f.complexity():0)},0)},toGrayscale:function(){for(var g=this.paths.length;g--;)this.paths[g].toGrayscale();return this},getObjects:function(){return this.paths}});m.PathGroup.fromObject=function(g){for(var f=g.paths,c=0,h=f.length;c<h;c++)if(!(f[c]instanceof m.Object)){var n=u(b(f[c].type));f[c]=m[n].fromObject(f[c])}return new m.PathGroup(f,g)}}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=m.util.object.extend,k=m.util.array.min,l=m.util.array.max,r=m.util.array.invoke,u=m.util.removeFromArray;if(!m.Group){m.Group=m.util.createClass(m.Object,{type:"group",initialize:function(b,g){this.objects=b||[];this.originalState={};this.callSuper("initialize");this._calcBounds();this._updateObjectsCoords();g&&d(this,g);this._setOpacityIfSame();this.setCoords(true);this.saveCoords();this.activateAllObjects()},_updateObjectsCoords:function(){var b=this.left,
g=this.top;this.forEachObject(function(f){var c=f.get("left"),h=f.get("top");f.set("originalLeft",c);f.set("originalTop",h);f.set("left",c-b);f.set("top",h-g);f.setCoords();f.hideCorners=true},this)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},getObjects:function(){return this.objects},add:function(b){this._restoreObjectsState();this.objects.push(b);b.setActive(true);this._calcBounds();this._updateObjectsCoords();return this},remove:function(b){this._restoreObjectsState();
u(this.objects,b);b.setActive(false);this._calcBounds();this._updateObjectsCoords();return this},size:function(){return this.getObjects().length},set:function(b,g){if(typeof g=="function")this.set(b,g(this[b]));else if(b==="fill"||b==="opacity"){var f=this.objects.length;for(this[b]=g;f--;)this.objects[f].set(b,g)}else this[b]=g;return this},contains:function(b){return this.objects.indexOf(b)>-1},toObject:function(){return d(this.callSuper("toObject"),{objects:r(this.objects,"clone")})},render:function(b){b.save();
this.transform(b);for(var g=Math.max(this.scaleX,this.scaleY),f=0,c;c=this.objects[f];f++){var h=c.borderScaleFactor;c.borderScaleFactor=g;c.render(b);c.borderScaleFactor=h}this.hideBorders||this.drawBorders(b);this.hideCorners||this.drawCorners(b);b.restore();this.setCoords()},item:function(b){return this.getObjects()[b]},complexity:function(){return this.getObjects().reduce(function(b,g){b+=typeof g.complexity=="function"?g.complexity():0;return b},0)},_restoreObjectsState:function(){this.objects.forEach(this._restoreObjectState,
this);return this},_restoreObjectState:function(b){var g=this.get("left"),f=this.get("top"),c=this.getAngle()*(Math.PI/180);b.get("originalLeft");b.get("originalTop");var h=Math.cos(c)*b.get("top")+Math.sin(c)*b.get("left");c=-Math.sin(c)*b.get("top")+Math.cos(c)*b.get("left");b.setAngle(b.getAngle()+this.getAngle());b.set("left",g+c*this.get("scaleX"));b.set("top",f+h*this.get("scaleY"));b.set("scaleX",b.get("scaleX")*this.get("scaleX"));b.set("scaleY",b.get("scaleY")*this.get("scaleY"));b.setCoords();
b.hideCorners=false;b.setActive(false);b.setCoords();return this},destroy:function(){return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(b){b.setCoords()});return this},activateAllObjects:function(){return this.setActive(true)},setActive:function(b){this.forEachObject(function(g){g.setActive(b)});
return this},forEachObject:function(b,g){for(var f=this.getObjects(),c=f.length;c--;)b.call(g,f[c],c,f);return this},_setOpacityIfSame:function(){var b=this.getObjects(),g=b[0]?b[0].get("opacity"):1;if(b.every(function(f){return f.get("opacity")===g}))this.opacity=g},_calcBounds:function(){var b=[],g=[],f,c;c=0;for(var h=this.objects.length;c<h;++c){f=this.objects[c];f.setCoords();for(var n in f.oCoords){b.push(f.oCoords[n].x);g.push(f.oCoords[n].y)}}f=k(b);c=l(b);b=k(g);g=l(g);c=c-f;g=g-b;this.width=
c;this.height=g;this.left=f+c/2;this.top=b+g/2},containsPoint:function(b){var g=this.get("width")/2,f=this.get("height")/2,c=this.get("left"),h=this.get("top");return c-g<b.x&&c+g>b.x&&h-f<b.y&&h+f>b.y},toGrayscale:function(){for(var b=this.objects.length;b--;)this.objects[b].toGrayscale()}});m.Group.fromObject=function(b){return new m.Group(b.objects,b)}}})(this);
(function(A){var m=A.fabric||(A.fabric={}),d=m.util.object.extend,k=m.util.object.clone;if(m.Text)m.warn("fabric.Text is already defined");else if(m.Object){m.Text=m.util.createClass(m.Object,{fontsize:20,fontweight:100,fontfamily:"Modernist_One_400",textDecoration:"",textShadow:null,fontStyle:"",path:null,type:"text",initialize:function(l,r){this._initStateProperties();this.text=l;this.setOptions(r);this.theta=this.angle*Math.PI/180;this.width=this.getWidth();this.setCoords()},_initStateProperties:function(){this.stateProperties=
this.stateProperties.concat();this.stateProperties.push("fontfamily","fontweight","path","text","textDecoration","textShadow","fontStyle");m.util.removeFromArray(this.stateProperties,"width")},toString:function(){return"#<fabric.Text ("+this.complexity()+"): "+JSON.stringify({text:this.text,fontfamily:this.fontfamily})+">"},_render:function(l){var r=Cufon.textOptions||(Cufon.textOptions={});r.left=this.left;r.top=this.top;r.context=l;r.color=this.fill;var u=this._initDummyElement();this.transform(l);
Cufon.replaceElement(u,{separate:"none",fontFamily:this.fontfamily,enableTextDecoration:true,textDecoration:this.textDecoration,textShadow:this.textShadow});this.width=r.width;this.height=r.height;this.setCoords()},_initDummyElement:function(){var l=document.createElement("div");document.createElement("div").appendChild(l);l.innerHTML=this.text;l.style.fontSize="40px";l.style.fontWeight="400";l.style.fontStyle="normal";l.style.letterSpacing="normal";l.style.color="#000000";l.style.fontWeight="600";
l.style.fontFamily="Verdana";return l},render:function(l){l.save();this._render(l);if(this.active){this.drawBorders(l);this.drawCorners(l)}l.restore()},toObject:function(){return d(this.callSuper("toObject"),{text:this.text,fontsize:this.fontsize,fontweight:this.fontweight,fontfamily:this.fontfamily,fontStyle:this.fontStyle,textDecoration:this.textDecoration,textShadow:this.textShadow,path:this.path})},setColor:function(l){this.set("fill",l);return this},setFontsize:function(l){this.set("fontsize",
l);this.setCoords();return this},getText:function(){return this.text},setText:function(l){this.set("text",l);this.setCoords();return this},set:function(l,r){this[l]=r;if(l==="fontfamily")this.path=this.path.replace(/(.*?)([^\/]*)(\.font\.js)/,"$1"+r+"$3");return this}});m.Text.fromObject=function(l){return new m.Text(l.text,k(l))};m.Text.fromElement=function(){}}else m.warn("fabric.Text requires fabric.Object")})(this);
(function(A){var m=fabric.util.object.extend;if(!A.fabric)A.fabric={};if(A.fabric.Image)fabric.warn("fabric.Image is already defined.");else if(fabric.Object){fabric.Image=fabric.util.createClass(fabric.Object,{maxwidth:null,maxheight:null,active:false,bordervisibility:false,cornervisibility:false,type:"image",__isGrayscaled:false,initialize:function(d,k){this.callSuper("initialize",k);this._initElement(d);this._initConfig(k||{})},getElement:function(){return this._element},setElement:function(d){this._element=
d;return this},getNormalizedSize:function(d,k,l){if(l&&k&&d.width>d.height&&d.width/d.height<k/l){normalizedWidth=~~(d.width*l/d.height);normalizedHeight=l}else if(l&&(d.height==d.width||d.height>d.width||d.height>l)){normalizedWidth=~~(d.width*l/d.height);normalizedHeight=l}else if(k&&k<d.width){normalizedHeight=~~(d.height*k/d.width);normalizedWidth=k}else{normalizedWidth=d.width;normalizedHeight=d.height}return{width:normalizedWidth,height:normalizedHeight}},getOriginalSize:function(){var d=this.getElement();
return{width:d.width,height:d.height}},setBorderVisibility:function(){this._resetWidthHeight();this._adjustWidthHeightToBorders(showBorder);this.setCoords()},setCornersVisibility:function(d){this.cornervisibility=!!d},render:function(d,k){d.save();k||this.transform(d);this._render(d);if(this.active&&!k){this.drawBorders(d);this.hideCorners||this.drawCorners(d)}d.restore()},toObject:function(){return m(this.callSuper("toObject"),{src:this.getSrc()})},getSrc:function(){return this.getElement().src},
toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(d){this.constructor.fromObject(this.toObject(),d)},toGrayscale:function(d){if(!this.__isGrayscaled){var k=this.getElement(),l=document.createElement("canvas"),r=document.createElement("img"),u=this;l.width=k.width;l.height=k.height;l.getContext("2d").drawImage(k,0,0);fabric.Element.toGrayscale(l);r.onload=function(){u.setElement(r);d&&d();r.onload=l=k=imageData=null};r.width=k.width;r.height=k.height;r.src=l.toDataURL("image/png");
this.__isGrayscaled=true;return this}},_render:function(d){var k=this.getOriginalSize();d.drawImage(this.getElement(),-k.width/2,-k.height/2,k.width,k.height)},_adjustWidthHeightToBorders:function(d){if(d){this.currentBorder=this.borderwidth;this.width+=2*this.currentBorder;this.height+=2*this.currentBorder}else this.currentBorder=0},_resetWidthHeight:function(){var d=this.getElement();this.set("width",d.width);this.set("height",d.height)},_initElement:function(d){this.setElement(fabric.util.getById(d));
fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(d){this.setOptions(d);this._setBorder();this._setWidthHeight(d)},_setBorder:function(){this.currentBorder=this.bordervisibility?this.borderwidth:0},_setWidthHeight:function(){var d=2*this.currentBorder;this.width=(this.getElement().width||0)+d;this.height=(this.getElement().height||0)+d},complexity:function(){return 1}});fabric.Image.CSS_CANVAS="canvas-img";fabric.Image.fromObject=function(d,k){var l=document.createElement("img"),
r=d.src;if(d.width)l.width=d.width;if(d.height)l.height=d.height;l.onload=function(){k&&k(new fabric.Image(l,d));l=l.onload=null};l.src=r};fabric.Image.fromURL=function(d,k,l){var r=document.createElement("img");r.onload=function(){k&&k(new fabric.Image(r,l));r=r.onload=null};r.src=d};fabric.Image.ATTRIBUTE_NAMES="x y width height fill fill-opacity stroke stroke-width transform xlink:href".split(" ");fabric.Image.fromElement=function(d,k,l){l||(l={});d=fabric.parseAttributes(d,fabric.Image.ATTRIBUTE_NAMES);
fabric.Image.fromURL(d["xlink:href"],k,m(d,l))};fabric.Image.fromElement.async=true}else fabric.warn("fabric.Object is required for fabric.Image initialization")})(this);
